<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</title>
</head>
<body>
<div id="header">
<h1 class="title">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</h1>
</div>
<h1 id="modelica.media.water.if97_utilities.baseif97.inverses"><a href="Modelica_Media_Water_IF97_Utilities_BaseIF97.html#Modelica.Media.Water.IF97_Utilities.BaseIF97">Modelica.Media.Water.IF97_Utilities.BaseIF97</a>.Inverses</h1>
<p><strong>efficient inverses for selected pairs of variables</strong></p>
<h2 id="information">Information</h2>
<p>::</p>
<h3 id="package-description">Package description</h3>
<h3 id="package-contents">Package contents</h3>
<ul>
<li>Function <strong>fixdT</strong> constrains density and temperature to allowed region</li>
<li>Function <strong>dofp13</strong> computes d as a function of p at boundary between regions 1 and 3</li>
<li>Function <strong>dofp23</strong> computes d as a function of p at boundary between regions 2 and 3</li>
<li>Function <strong>dofpt3</strong> iteration to compute d as a function of p and T in region 3</li>
<li>Function <strong>dtofph3</strong> iteration to compute d and T as a function of p and h in region 3</li>
<li>Function <strong>dtofps3</strong> iteration to compute d and T as a function of p and s in region 3</li>
<li>Function <strong>dtofpsdt3</strong> iteration to compute d and T as a function of p and s in region 3, with initial guesses</li>
<li>Function <strong>pofdt125</strong> iteration to compute p as a function of p and T in regions 1, 2 and 5</li>
<li>Function <strong>tofph5</strong> iteration to compute T as a function of p and h in region 5</li>
<li>Function <strong>tofps5</strong> iteration to compute T as a function of p and s in region 5</li>
<li>Function <strong>tofpst5</strong> iteration to compute T as a function of p and s in region 5, with initial guess in T</li>
<li>Function *<em>*</em></li>
</ul>
<h3 id="version-info-and-revision-history">Version Info and Revision history</h3>
<ul>
<li>First implemented: <em>July, 2000</em> by <a href="http://www.control.lth.se/~hubertus/">Hubertus Tummescheit</a></li>
</ul>
<dl>
<dt>Author: Hubertus Tummescheit,</dt>
<dd><p>Modelon AB Ideon Science Park SE-22370 Lund, Sweden email: <script type="text/javascript">
<!--
h='&#x6d;&#x6f;&#100;&#x65;&#108;&#x6f;&#110;&#46;&#x73;&#x65;';a='&#64;';n='&#104;&#x75;&#98;&#x65;&#114;&#116;&#x75;&#x73;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'<code>'+e+'</code>'+'<\/'+'a'+'>');
// -->
</script><noscript>&#104;&#x75;&#98;&#x65;&#114;&#116;&#x75;&#x73;&#32;&#x61;&#116;&#32;&#x6d;&#x6f;&#100;&#x65;&#108;&#x6f;&#110;&#32;&#100;&#x6f;&#116;&#32;&#x73;&#x65;</noscript></p>
</dd>
</dl>
<ul>
<li>Initial version: July 2000</li>
<li>Documentation added: December 2002</li>
</ul>
<p>::</p>
<p>Extends from <a href="Modelica_Icons_Package.html#Modelica.Icons.Package">Modelica.Icons.Package</a> (Icon for standard packages).</p>
<h2 id="package-content">Package Content</h2>
<table>
<col width="79%" />
<col width="20%" />
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image11" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdT">fixdT</a></td>
<td align="left">region limits for inverse iteration in region 3</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image12" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dofp13">dofp13</a></td>
<td align="left">density at the boundary between regions 1 and 3</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image13" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dofp23">dofp23</a></td>
<td align="left">density at the boundary between regions 2 and 3</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image14" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dofpt3">dofpt3</a></td>
<td align="left">inverse iteration in region 3: (d) = f(p,T)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image15" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dtofph3">dtofph3</a></td>
<td align="left">inverse iteration in region 3: (d,T) = f(p,h)</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image16" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dtofps3">dtofps3</a></td>
<td align="left">inverse iteration in region 3: (d,T) = f(p,s)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image17" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.dtofpsdt3">dtofpsdt3</a></td>
<td align="left">inverse iteration in region 3: (d,T) = f(p,s)</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image18" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.pofdt125">pofdt125</a></td>
<td align="left">inverse iteration in region 1,2 and 5: p = g(d,T)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image19" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.tofph5">tofph5</a></td>
<td align="left">inverse iteration in region 5: (p,T) = f(p,h)</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image20" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.tofps5">tofps5</a></td>
<td align="left">inverse iteration in region 5: (p,T) = f(p,s)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.extraDerivs_phS.png" alt="image21" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.tofpst5">tofpst5</a></td>
<td align="left">inverse iteration in region 5: (p,T) = f(p,s)</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="image22-modelica.media.water.if97_utilities.baseif97.inverses.fixdt"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image22" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.fixdT</h1>
<p><strong>region limits for inverse iteration in region 3</strong></p>
<h2 id="information-1">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs">Inputs</h2>
<table>
<col width="63%" />
<col width="7%" />
<col width="10%" />
<col width="17%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">din</td>
<td align="left">
</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">Tin</td>
<td align="left">
</td>
<td align="left">temperature [K]</td>
</tr>
</tbody>
</table>
<h2 id="outputs">Outputs</h2>
<table>
<col width="71%" />
<col width="8%" />
<col width="19%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">dout</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">Tout</td>
<td align="left">temperature [K]</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition">Modelica definition</h2>
<pre><code>function fixdT &quot;region limits for inverse iteration in region 3&quot;

  extends Modelica.Icons.Function;
  input SI.Density din &quot;density&quot;;
  input SI.Temperature Tin &quot;temperature&quot;;
  output SI.Density dout &quot;density&quot;;
  output SI.Temperature Tout &quot;temperature&quot;;
protected 
  SI.Temperature Tmin &quot;approximation of minimum temperature&quot;;
  SI.Temperature Tmax &quot;approximation of maximum temperature&quot;;
algorithm 
  if (din &gt; 765.0) then
    dout := 765.0;
  elseif (din &lt; 110.0) then
    dout := 110.0;
  else
    dout := din;
  end if;
  if (dout &lt; 390.0) then
    Tmax := 554.3557377 + dout*0.809344262;
  else
    Tmax := 1116.85 - dout*0.632948717;
  end if;
  if (dout &lt; data.DCRIT) then
    Tmin := data.TCRIT*(1.0 - (dout - data.DCRIT)*(dout - data.DCRIT)/
      1.0e6);
  else
    Tmin := data.TCRIT*(1.0 - (dout - data.DCRIT)*(dout - data.DCRIT)/
      1.44e6);
  end if;
  if (Tin &lt; Tmin) then
    Tout := Tmin;
  elseif (Tin &gt; Tmax) then
    Tout := Tmax;
  else
    Tout := Tin;
  end if;
end fixdT;</code></pre>
<hr />
<h1 id="image23-modelica.media.water.if97_utilities.baseif97.inverses.dofp13"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image23" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dofp13</h1>
<p><strong>density at the boundary between regions 1 and 3</strong></p>
<h2 id="information-2">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-1">Inputs</h2>
<table>
<col width="62%" />
<col width="8%" />
<col width="11%" />
<col width="17%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-1">Outputs</h2>
<table>
<col width="68%" />
<col width="9%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-1">Modelica definition</h2>
<pre><code>function dofp13 &quot;density at the boundary between regions 1 and 3&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  output SI.Density d &quot;density&quot;;
protected 
  Real p2 &quot;auxiliary variable&quot;;
  Real[3] o &quot;vector of auxiliary variables&quot;;
algorithm 
  p2 := 7.1 - 6.04960677555959e-8*p;
  o[1] := p2*p2;
  o[2] := o[1]*o[1];
  o[3] := o[2]*o[2];
  d := 57.4756752485113/(0.0737412153522555 + p2*(0.00145092247736023 +
    p2*(0.000102697173772229 + p2*(0.0000114683182476084 + p2*(
    1.99080616601101e-6 + o[1]*p2*(1.13217858826367e-8 + o[2]*o[3]*p2*(
    1.35549330686006e-17 + o[1]*(-3.11228834832975e-19 + o[1]*o[2]*(-7.02987180039442e-22
     + p2*(3.29199117056433e-22 + (-5.17859076694812e-23 +
    2.73712834080283e-24*p2)*p2))))))))));

end dofp13;</code></pre>
<hr />
<h1 id="image24-modelica.media.water.if97_utilities.baseif97.inverses.dofp23"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image24" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dofp23</h1>
<p><strong>density at the boundary between regions 2 and 3</strong></p>
<h2 id="information-3">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-2">Inputs</h2>
<table>
<col width="62%" />
<col width="8%" />
<col width="11%" />
<col width="17%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-2">Outputs</h2>
<table>
<col width="68%" />
<col width="9%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-2">Modelica definition</h2>
<pre><code>function dofp23 &quot;density at the boundary between regions 2 and 3&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  output SI.Density d &quot;density&quot;;
protected 
  SI.Temperature T;
  Real[13] o &quot;vector of auxiliary variables&quot;;
  Real taug &quot;auxiliary variable&quot;;
  Real pi &quot;dimensionless pressure&quot;;
  Real gpi23 
    &quot;derivative of g w.r.t. pi on the boundary between regions 2 and 3&quot;;
algorithm 
  pi := p/data.PSTAR2;
  T := 572.54459862746 + 31.3220101646784*(-13.91883977887 + pi)^0.5;
  o[1] := (-13.91883977887 + pi)^0.5;
  taug := -0.5 + 540.0/(572.54459862746 + 31.3220101646784*o[1]);
  o[2] := taug*taug;
  o[3] := o[2]*taug;
  o[4] := o[2]*o[2];
  o[5] := o[4]*o[4];
  o[6] := o[5]*o[5];
  o[7] := o[4]*o[5]*o[6]*taug;
  o[8] := o[4]*o[5]*taug;
  o[9] := o[2]*o[4]*o[5];
  o[10] := pi*pi;
  o[11] := o[10]*o[10];
  o[12] := o[4]*o[6]*taug;
  o[13] := o[6]*o[6];

  gpi23 := (1.0 + pi*(-0.0017731742473213 + taug*(-0.017834862292358 +
    taug*(-0.045996013696365 + (-0.057581259083432 - 0.05032527872793*o[3])
    *taug)) + pi*(taug*(-0.000066065283340406 + (-0.0003789797503263 + o[
    2]*(-0.007878555448671 + o[3]*(-0.087594591301146 -
    0.000053349095828174*o[7])))*taug) + pi*(6.1445213076927e-8 + (
    1.31612001853305e-6 + o[2]*(-0.00009683303171571 + o[3]*(-0.0045101773626444
     - 0.122004760687947*o[7])))*taug + pi*(taug*(-3.15389238237468e-9 +
    (5.116287140914e-8 + 1.92901490874028e-6*taug)*taug) + pi*(
    0.0000114610381688305*o[2]*o[4]*taug + pi*(o[3]*(-1.00288598706366e-10
     + o[8]*(-0.012702883392813 - 143.374451604624*o[2]*o[6]*taug)) + pi*
    (-4.1341695026989e-17 + o[2]*o[5]*(-8.8352662293707e-6 -
    0.272627897050173*o[9])*taug + pi*(o[5]*(9.0049690883672e-11 -
    65.8490727183984*o[4]*o[5]*o[6]) + pi*(1.78287415218792e-7*o[8] + pi*
    (o[4]*(1.0406965210174e-18 + o[2]*(-1.0234747095929e-12 -
    1.0018179379511e-8*o[4])*o[4]) + o[10]*o[11]*((-1.29412653835176e-9
     + 1.71088510070544*o[12])*o[7] + o[10]*(-6.05920510335078*o[13]*o[5]
    *o[6]*taug + o[10]*(o[4]*o[6]*(1.78371690710842e-23 + o[2]*o[4]*o[5]*
    (6.1258633752464e-12 - 0.000084004935396416*o[8])*taug) + pi*(-1.24017662339842e-24
    *o[12] + pi*(0.0000832192847496054*o[13]*o[4]*o[6]*taug + pi*(o[2]*o[
    5]*o[6]*(1.75410265428146e-27 + (1.32995316841867e-15 -
    0.0000226487297378904*o[2]*o[6])*o[9])*pi - 2.93678005497663e-14*o[13]
    *o[2]*o[4]*taug)))))))))))))))))/pi;
  d := p/(data.RH2O*T*pi*gpi23);
end dofp23;</code></pre>
<hr />
<h1 id="image25-modelica.media.water.if97_utilities.baseif97.inverses.dofpt3"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image25" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dofpt3</h1>
<p><strong>inverse iteration in region 3: (d) = f(p,T)</strong></p>
<h2 id="information-4">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-3">Inputs</h2>
<table>
<col width="50%" />
<col width="6%" />
<col width="8%" />
<col width="34%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">
</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">delp</td>
<td align="left">
</td>
<td align="left">iteration converged if (p-pre(p) &lt; delp) [Pa]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-3">Outputs</h2>
<table>
<col width="50%" />
<col width="7%" />
<col width="41%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-3">Modelica definition</h2>
<pre><code>function dofpt3 &quot;inverse iteration in region 3: (d) = f(p,T)&quot;

  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.Temperature T &quot;temperature (K)&quot;;
  input SI.Pressure delp &quot;iteration converged if (p-pre(p) &lt; delp)&quot;;
  output SI.Density d &quot;density&quot;;
  output Integer error=0 &quot;error flag: iteration failed if different from 0&quot;;
protected 
  SI.Density dguess &quot;guess density&quot;;
  Integer i=0 &quot;loop counter&quot;;
  Real dp &quot;pressure difference&quot;;
  SI.Density deld &quot;density step&quot;;
  Modelica.Media.Common.HelmholtzDerivs f 
    &quot;dimensionless Helmholtz function and dervatives w.r.t. delta and tau&quot;;
  Modelica.Media.Common.NewtonDerivatives_pT nDerivs 
    &quot;derivatives needed in Newton iteration&quot;;
  Boolean found=false &quot;flag for iteration success&quot;;
  Boolean supercritical &quot;flag, true for supercritical states&quot;;
  Boolean liquid &quot;flag, true for liquid states&quot;;
  SI.Density dmin &quot;lower density limit&quot;;
  SI.Density dmax &quot;upper density limit&quot;;
  SI.Temperature Tmax &quot;maximum temperature&quot;;
algorithm 
  assert(p &gt;= data.PLIMIT4A,
    &quot;BaseIF97.dofpt3: function called outside of region 3! p too low\n&quot; +
    &quot;p = &quot; + String(p) + &quot; Pa &lt; &quot; + String(data.PLIMIT4A) + &quot; Pa&quot;);
  assert(T &gt;= data.TLIMIT1,
    &quot;BaseIF97.dofpt3: function called outside of region 3! T too low\n&quot; +
    &quot;T = &quot; + String(T) + &quot; K &lt; &quot; + String(data.TLIMIT1) + &quot; K&quot;);
  assert(p &gt;= Regions.boundary23ofT(T),
    &quot;BaseIF97.dofpt3: function called outside of region 3! T too high\n&quot; +
    &quot;p = &quot; + String(p) + &quot; Pa, T = &quot; + String(T) + &quot; K&quot;);
  supercritical := p &gt; data.PCRIT;
  dmax := dofp13(p);
  dmin := dofp23(p);
  Tmax := Regions.boundary23ofp(p);
  if supercritical then
    dguess := dmin + (T - data.TLIMIT1)/(data.TLIMIT1 - Tmax)*(dmax -
      dmin);
    //this may need improvement!!
  else
    liquid := T &lt; Basic.tsat(p);
    if liquid then
      dguess := 0.5*(Regions.rhol_p_R4b(p) + dmax);
    else
      dguess := 0.5*(Regions.rhov_p_R4b(p) + dmin);
    end if;
  end if;
  while ((i &lt; IterationData.IMAX) and not found) loop
    d := dguess;
    f := Basic.f3(d, T);
    nDerivs := Modelica.Media.Common.Helmholtz_pT(f);
    dp := nDerivs.p - p;
    if (abs(dp/p) &lt;= delp) then
      found := true;
    end if;
    deld := dp/nDerivs.pd;
    d := d - deld;
    if d &gt; dmin and d &lt; dmax then
      dguess := d;
    else
      if d &gt; dmax then
        dguess := dmax - sqrt(Modelica.Constants.eps);
          // put it on the correct spot just inside the boundary here instead
      else
        dguess := dmin + sqrt(Modelica.Constants.eps);
      end if;
    end if;
    i := i + 1;
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1, &quot;error in inverse function dofpt3: iteration failed&quot;);
end dofpt3;</code></pre>
<hr />
<h1 id="image26-modelica.media.water.if97_utilities.baseif97.inverses.dtofph3"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image26" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dtofph3</h1>
<p><strong>inverse iteration in region 3: (d,T) = f(p,h)</strong></p>
<h2 id="information-5">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-4">Inputs</h2>
<table>
<col width="61%" />
<col width="6%" />
<col width="9%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy">SpecificEnthalpy</a></td>
<td align="left">h</td>
<td align="left">
</td>
<td align="left">specific enthalpy [J/kg]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">delp</td>
<td align="left">
</td>
<td align="left">iteration accuracy [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy">SpecificEnthalpy</a></td>
<td align="left">delh</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/kg]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-4">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="odd">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-4">Modelica definition</h2>
<pre><code>function dtofph3 &quot;inverse iteration in region 3: (d,T) = f(p,h)&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEnthalpy h &quot;specific enthalpy&quot;;
  input SI.Pressure delp &quot;iteration accuracy&quot;;
  input SI.SpecificEnthalpy delh &quot;iteration accuracy&quot;;
  output SI.Density d &quot;density&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;
protected 
  SI.Temperature Tguess &quot;initial temperature&quot;;
  SI.Density dguess &quot;initial density&quot;;
  Integer i &quot;iteration counter&quot;;
  Real dh &quot;Newton-error in h-direction&quot;;
  Real dp &quot;Newton-error in p-direction&quot;;
  Real det &quot;determinant of directional derivatives&quot;;
  Real deld &quot;Newton-step in d-direction&quot;;
  Real delt &quot;Newton-step in T-direction&quot;;
  Modelica.Media.Common.HelmholtzDerivs f 
    &quot;dimensionless Helmholtz function and dervatives w.r.t. delta and tau&quot;;
  Modelica.Media.Common.NewtonDerivatives_ph nDerivs 
    &quot;derivatives needed in Newton iteration&quot;;
  Boolean found &quot;flag for iteration success&quot;;
  Integer subregion &quot;1 for subregion 3a, 2 for subregion 3b&quot;;
algorithm 
  if p &lt; data.PCRIT then
    // allow a 10 J margin inside the (well approximated) phase boundary
    subregion := if h &lt; (Regions.hl_p(p) + 10.0) then 1 else 
      if h &gt; (Regions.hv_p(p) - 10.0) then 2 else 0;
    assert(subregion &lt;&gt; 0,&quot;inverse iteration of dt from ph called in 2 phase region: this can not work&quot;);
  else
    //supercritical
    subregion := if h &lt; Basic.h3ab_p(p) then 1 else 2;
  end if;
  T := if subregion == 1 then Basic.T3a_ph(p,h) else Basic.T3b_ph(p,h);
  d := if subregion == 1 then 1/Basic.v3a_ph(p,h) else 1/Basic.v3b_ph(p,h);
  i := 0;
  error := 0;
  while ((i &lt; IterationData.IMAX) and not found) loop
    f := Basic.f3(d, T);
    nDerivs := Modelica.Media.Common.Helmholtz_ph(f);
    dh := nDerivs.h - h;
    dp := nDerivs.p - p;
    if ((abs(dh/h) &lt;= delh) and (abs(dp/p) &lt;= delp)) then
      found := true;
    end if;
    det := nDerivs.ht*nDerivs.pd - nDerivs.pt*nDerivs.hd;
    delt := (nDerivs.pd*dh - nDerivs.hd*dp)/det;
    deld := (nDerivs.ht*dp - nDerivs.pt*dh)/det;
    T := T - delt;
    d := d - deld;
    dguess := d;
    Tguess := T;
    i := i + 1;
    (d,T) := fixdT(dguess, Tguess);
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1,
    &quot;error in inverse function dtofph3: iteration failed&quot;);
end dtofph3;</code></pre>
<hr />
<h1 id="image27-modelica.media.water.if97_utilities.baseif97.inverses.dtofps3"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image27" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dtofps3</h1>
<p><strong>inverse iteration in region 3: (d,T) = f(p,s)</strong></p>
<h2 id="information-6">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-5">Inputs</h2>
<table>
<col width="59%" />
<col width="6%" />
<col width="8%" />
<col width="25%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">s</td>
<td align="left">
</td>
<td align="left">specific entropy [J/(kg.K)]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">delp</td>
<td align="left">
</td>
<td align="left">iteration accuracy [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">dels</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/(kg.K)]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-5">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="odd">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-5">Modelica definition</h2>
<pre><code>function dtofps3 &quot;inverse iteration in region 3: (d,T) = f(p,s)&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEntropy s &quot;specific entropy&quot;;
  input SI.Pressure delp &quot;iteration accuracy&quot;;
  input SI.SpecificEntropy dels &quot;iteration accuracy&quot;;
  output SI.Density d &quot;density&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;
protected 
  SI.Temperature Tguess &quot;initial temperature&quot;;
  SI.Density dguess &quot;initial density&quot;;
  Integer i &quot;iteration counter&quot;;
  Real ds &quot;Newton-error in s-direction&quot;;
  Real dp &quot;Newton-error in p-direction&quot;;
  Real det &quot;determinant of directional derivatives&quot;;
  Real deld &quot;Newton-step in d-direction&quot;;
  Real delt &quot;Newton-step in T-direction&quot;;
  Modelica.Media.Common.HelmholtzDerivs f 
    &quot;dimensionless Helmholtz function and dervatives w.r.t. delta and tau&quot;;
  Modelica.Media.Common.NewtonDerivatives_ps nDerivs 
    &quot;derivatives needed in Newton iteration&quot;;
  Boolean found &quot;flag for iteration success&quot;;
  Integer subregion &quot;1 for subregion 3a, 2 for subregion 3b&quot;;
algorithm 
  i := 0;
  error := 0;
  found := false;
  if p &lt; data.PCRIT then
    // allow a 1 J/K margin inside the (well approximated) phase boundary
    subregion := if s &lt; (Regions.sl_p(p) + 10.0) then 1 else 
      if s &gt; (Regions.sv_p(p) - 10.0) then 2 else 0;
    assert(subregion &lt;&gt; 0,&quot;inverse iteration of dt from ps called in 2 phase region: this is illegal!&quot;);
  else
    subregion := if s &lt; data.SCRIT then 1 else 2;
  end if;
  T := if subregion == 1 then Basic.T3a_ps(p,s) else Basic.T3b_ps(p,s);
  d := if subregion == 1 then 1/Basic.v3a_ps(p,s) else 1/Basic.v3b_ps(p,s);
  while ((i &lt; IterationData.IMAX) and not found) loop
    f := Basic.f3(d, T);
    nDerivs := Modelica.Media.Common.Helmholtz_ps(f);
    ds := nDerivs.s - s;
    dp := nDerivs.p - p;
    if ((abs(ds/s) &lt;= dels) and (abs(dp/p) &lt;= delp)) then
      found := true;
    end if;
    det := nDerivs.st*nDerivs.pd - nDerivs.pt*nDerivs.sd;
    delt := (nDerivs.pd*ds - nDerivs.sd*dp)/det;
    deld := (nDerivs.st*dp - nDerivs.pt*ds)/det;
    T := T - delt;
    d := d - deld;
    dguess := d;
    Tguess := T;
    i := i + 1;
    (d,T) := fixdT(dguess, Tguess);
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1,
    &quot;error in inverse function dtofps3: iteration failed&quot;);
end dtofps3;</code></pre>
<hr />
<h1 id="image28-modelica.media.water.if97_utilities.baseif97.inverses.dtofpsdt3"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image28" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.dtofpsdt3</h1>
<p><strong>inverse iteration in region 3: (d,T) = f(p,s)</strong></p>
<h2 id="information-7">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-6">Inputs</h2>
<table>
<col width="50%" />
<col width="7%" />
<col width="7%" />
<col width="34%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">s</td>
<td align="left">
</td>
<td align="left">specific entropy [J/(kg.K)]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">dguess</td>
<td align="left">
</td>
<td align="left">guess density, e.g., from adjacent volume [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">Tguess</td>
<td align="left">
</td>
<td align="left">guess temperature, e.g., from adjacent volume [K]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">delp</td>
<td align="left">
</td>
<td align="left">iteration accuracy [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">dels</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/(kg.K)]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-6">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="odd">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-6">Modelica definition</h2>
<pre><code>function dtofpsdt3 &quot;inverse iteration in region 3: (d,T) = f(p,s)&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEntropy s &quot;specific entropy&quot;;
  input SI.Density dguess &quot;guess density, e.g., from adjacent volume&quot;;
  input SI.Temperature Tguess &quot;guess temperature, e.g., from adjacent volume&quot;;
  input SI.Pressure delp &quot;iteration accuracy&quot;;
  input SI.SpecificEntropy dels &quot;iteration accuracy&quot;;
  output SI.Density d &quot;density&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;
protected 
  Integer i &quot;iteration counter&quot;;
  Real ds &quot;Newton-error in s-direction&quot;;
  Real dp &quot;Newton-error in p-direction&quot;;
  Real det &quot;determinant of directional derivatives&quot;;
  Real deld &quot;Newton-step in d-direction&quot;;
  Real delt &quot;Newton-step in T-direction&quot;;
  Modelica.Media.Common.HelmholtzDerivs f 
    &quot;dimensionless Helmholtz function and dervatives w.r.t. delta and tau&quot;;
  Modelica.Media.Common.NewtonDerivatives_ps nDerivs 
    &quot;derivatives needed in Newton iteration&quot;;
  Boolean found &quot;flag for iteration success&quot;;
  SI.Density diter &quot;density&quot;;
  SI.Temperature Titer &quot;temperature (K)&quot;;
algorithm 
  i := 0;
  error := 0;
  found := false;
  (diter,Titer) := fixdT(dguess, Tguess);
  while ((i &lt; IterationData.IMAX) and not found) loop
    (d,T) := fixdT(diter, Titer);
    f := Basic.f3(d, T);
    nDerivs := Modelica.Media.Common.Helmholtz_ps(f);
    ds := nDerivs.s - s;
    dp := nDerivs.p - p;
    if ((abs(ds/s) &lt;= dels) and (abs(dp/p) &lt;= delp)) then
      found := true;
    end if;
    det := nDerivs.st*nDerivs.pd - nDerivs.pt*nDerivs.sd;
    delt := (nDerivs.pd*ds - nDerivs.sd*dp)/det;
    deld := (nDerivs.st*dp - nDerivs.pt*ds)/det;
    T := T - delt;
    d := d - deld;
    diter := d;
    Titer := T;
    i := i + 1;
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1,
    &quot;error in inverse function dtofpsdt3: iteration failed&quot;);
end dtofpsdt3;</code></pre>
<hr />
<h1 id="image29-modelica.media.water.if97_utilities.baseif97.inverses.pofdt125"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image29" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.pofdt125</h1>
<p><strong>inverse iteration in region 1,2 and 5: p = g(d,T)</strong></p>
<h2 id="information-8">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-7">Inputs</h2>
<table>
<col width="45%" />
<col width="6%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Density">Density</a></td>
<td align="left">d</td>
<td align="left">
</td>
<td align="left">density [kg/m3]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">
</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">reldd</td>
<td align="left">
</td>
<td align="left">relative iteration accuracy of density [Pa]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">region</td>
<td align="left">
</td>
<td align="left">region in IAPWS/IF97 in which inverse should be calculated</td>
</tr>
</tbody>
</table>
<h2 id="outputs-7">Outputs</h2>
<table>
<col width="51%" />
<col width="7%" />
<col width="41%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-7">Modelica definition</h2>
<pre><code>function pofdt125 &quot;inverse iteration in region 1,2 and 5: p = g(d,T)&quot;
  extends Modelica.Icons.Function;
  input SI.Density d &quot;density&quot;;
  input SI.Temperature T &quot;temperature (K)&quot;;
  input SI.Pressure reldd &quot;relative iteration accuracy of density&quot;;
  input Integer region 
    &quot;region in IAPWS/IF97 in which inverse should be calculated&quot;;
  output SI.Pressure p &quot;pressure&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;
protected 
  Integer i &quot;counter for while-loop&quot;;
  Modelica.Media.Common.GibbsDerivs g 
    &quot;dimensionless Gibbs funcion and dervatives w.r.t. pi and tau&quot;;
  Boolean found &quot;flag if iteration has been successful&quot;;
  Real dd &quot;difference between density for  guessed p and the current density&quot;;
  Real delp &quot;step in p in Newton-iteration&quot;;
  Real relerr &quot;relative error in d&quot;;
  SI.Pressure pguess1=1.0e6 &quot;initial pressure guess in region 1&quot;;
  SI.Pressure pguess2 &quot;initial pressure guess in region 2&quot;;
  constant SI.Pressure pguess5=0.5e6 &quot;initial pressure guess in region 5&quot;;
algorithm 
  i := 0;
  error := 0;
  pguess2 := 42800*d;
  found := false;
  if region == 1 then
    p := pguess1;
  elseif region == 2 then
    p := pguess2;
  else
    p := pguess5;
  end if;
  while ((i &lt; IterationData.IMAX) and not found) loop
    if region == 1 then
      g := Basic.g1(p, T);
    elseif region == 2 then
      g := Basic.g2(p, T);
    else
      g := Basic.g5(p, T);
    end if;
    dd := p/(data.RH2O*T*g.pi*g.gpi) - d;
    relerr := dd/d;
    if (abs(relerr) &lt; reldd) then
      found := true;
    end if;
    delp := dd*(-p*p/(d*d*data.RH2O*T*g.pi*g.pi*g.gpipi));
    p := p - delp;
    i := i + 1;
    if not found then
      if p &lt; triple.ptriple then
        p := 2.0*triple.ptriple;
      end if;
      if p &gt; data.PLIMIT1 then
        p := 0.95*data.PLIMIT1;
      end if;
    end if;
  end while;

    // print(&quot;i = &quot; + i2s(i) + &quot;, p = &quot; + r2s(p/1.0e5) + &quot;, delp = &quot; + r2s(delp*1.0e-5) + &quot;\n&quot;);
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1,
    &quot;error in inverse function pofdt125: iteration failed&quot;);
end pofdt125;</code></pre>
<hr />
<h1 id="image30-modelica.media.water.if97_utilities.baseif97.inverses.tofph5"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image30" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.tofph5</h1>
<p><strong>inverse iteration in region 5: (p,T) = f(p,h)</strong></p>
<h2 id="information-9">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-8">Inputs</h2>
<table>
<col width="61%" />
<col width="7%" />
<col width="8%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy">SpecificEnthalpy</a></td>
<td align="left">h</td>
<td align="left">
</td>
<td align="left">specific enthalpy [J/kg]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy">SpecificEnthalpy</a></td>
<td align="left">reldh</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/kg]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-8">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-8">Modelica definition</h2>
<pre><code>function tofph5 &quot;inverse iteration in region 5: (p,T) = f(p,h)&quot;

  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEnthalpy h &quot;specific enthalpy&quot;;
  input SI.SpecificEnthalpy reldh &quot;iteration accuracy&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;

protected 
  Modelica.Media.Common.GibbsDerivs g 
    &quot;dimensionless Gibbs funcion and dervatives w.r.t. pi and tau&quot;;
  SI.SpecificEnthalpy proh &quot;h for current guess in T&quot;;
  constant SI.Temperature Tguess=1500 &quot;initial temperature&quot;;
  Integer i &quot;iteration counter&quot;;
  Real relerr &quot;relative error in h&quot;;
  Real dh &quot;Newton-error in h-direction&quot;;
  Real dT &quot;Newton-step in T-direction&quot;;
  Boolean found &quot;flag for iteration success&quot;;
algorithm 
  i := 0;
  error := 0;
  T := Tguess;
  found := false;
  while ((i &lt; IterationData.IMAX) and not found) loop
    g := Basic.g5(p, T);
    proh := data.RH2O*T*g.tau*g.gtau;
    dh := proh - h;
    relerr := dh/h;
    if (abs(relerr) &lt; reldh) then
      found := true;
    end if;
    dT := dh/(-data.RH2O*g.tau*g.tau*g.gtautau);
    T := T - dT;
    i := i + 1;
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1, &quot;error in inverse function tofph5: iteration failed&quot;);
end tofph5;</code></pre>
<hr />
<h1 id="image31-modelica.media.water.if97_utilities.baseif97.inverses.tofps5"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image31" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.tofps5</h1>
<p><strong>inverse iteration in region 5: (p,T) = f(p,s)</strong></p>
<h2 id="information-10">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-9">Inputs</h2>
<table>
<col width="60%" />
<col width="7%" />
<col width="8%" />
<col width="23%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">s</td>
<td align="left">
</td>
<td align="left">specific entropy [J/(kg.K)]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy">SpecificEnthalpy</a></td>
<td align="left">relds</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/kg]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-9">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-9">Modelica definition</h2>
<pre><code>function tofps5 &quot;inverse iteration in region 5: (p,T) = f(p,s)&quot;

  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEntropy s &quot;specific entropy&quot;;
  input SI.SpecificEnthalpy relds &quot;iteration accuracy&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;

protected 
  Modelica.Media.Common.GibbsDerivs g 
    &quot;dimensionless Gibbs funcion and dervatives w.r.t. pi and tau&quot;;
  SI.SpecificEntropy pros &quot;s for current guess in T&quot;;
  parameter SI.Temperature Tguess=1500 &quot;initial temperature&quot;;
  Integer i &quot;iteration counter&quot;;
  Real relerr &quot;relative error in s&quot;;
  Real ds &quot;Newton-error in s-direction&quot;;
  Real dT &quot;Newton-step in T-direction&quot;;
  Boolean found &quot;flag for iteration success&quot;;
algorithm 
  i := 0;
  error := 0;
  T := Tguess;
  found := false;
  while ((i &lt; IterationData.IMAX) and not found) loop
    g := Basic.g5(p, T);
    pros := data.RH2O*(g.tau*g.gtau - g.g);
    ds := pros - s;
    relerr := ds/s;
    if (abs(relerr) &lt; relds) then
      found := true;
    end if;
    dT := ds*T/(-data.RH2O*g.tau*g.tau*g.gtautau);
    T := T - dT;
    i := i + 1;
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1, &quot;error in inverse function tofps5: iteration failed&quot;);
end tofps5;</code></pre>
<hr />
<h1 id="image32-modelica.media.water.if97_utilities.baseif97.inverses.tofpst5"><img src="Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses.fixdTI.png" alt="image32" /> <a href="Modelica_Media_Water_IF97_Utilities_BaseIF97_Inverses.html#Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses">Modelica.Media.Water.IF97_Utilities.BaseIF97.Inverses</a>.tofpst5</h1>
<p><strong>inverse iteration in region 5: (p,T) = f(p,s)</strong></p>
<h2 id="information-11">Information</h2>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Function">Modelica.Icons.Function</a> (Icon for functions).</p>
<h2 id="inputs-10">Inputs</h2>
<table>
<col width="50%" />
<col width="7%" />
<col width="7%" />
<col width="34%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Pressure">Pressure</a></td>
<td align="left">p</td>
<td align="left">
</td>
<td align="left">pressure [Pa]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">s</td>
<td align="left">
</td>
<td align="left">specific entropy [J/(kg.K)]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">Tguess</td>
<td align="left">
</td>
<td align="left">guess temperature, e.g., from adjacent volume [K]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.SpecificEntropy">SpecificEntropy</a></td>
<td align="left">relds</td>
<td align="left">
</td>
<td align="left">iteration accuracy [J/(kg.K)]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-10">Outputs</h2>
<table>
<col width="53%" />
<col width="7%" />
<col width="39%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temperature">Temperature</a></td>
<td align="left">T</td>
<td align="left">temperature (K) [K]</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">error</td>
<td align="left">error flag: iteration failed if different from 0</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-10">Modelica definition</h2>
<pre><code>function tofpst5 &quot;inverse iteration in region 5: (p,T) = f(p,s)&quot;
  extends Modelica.Icons.Function;
  input SI.Pressure p &quot;pressure&quot;;
  input SI.SpecificEntropy s &quot;specific entropy&quot;;
  input SI.Temperature Tguess &quot;guess temperature, e.g., from adjacent volume&quot;;
  input SI.SpecificEntropy relds &quot;iteration accuracy&quot;;
  output SI.Temperature T &quot;temperature (K)&quot;;
  output Integer error &quot;error flag: iteration failed if different from 0&quot;;

protected 
  Modelica.Media.Common.GibbsDerivs g 
    &quot;dimensionless Gibbs funcion and dervatives w.r.t. pi and tau&quot;;
  SI.SpecificEntropy pros &quot;s for current guess in T&quot;;
  Integer i &quot;iteration counter&quot;;
  Real relerr &quot;relative error in s&quot;;
  Real ds &quot;Newton-error in s-direction&quot;;
  Real dT &quot;Newton-step in T-direction&quot;;
  Boolean found &quot;flag for iteration success&quot;;
algorithm 
  i := 0;
  error := 0;
  T := Tguess;
  found := false;
  while ((i &lt; IterationData.IMAX) and not found) loop
    g := Basic.g5(p, T);
    pros := data.RH2O*(g.tau*g.gtau - g.g);
    ds := pros - s;
    relerr := ds/s;
    if (abs(relerr) &lt; relds) then
      found := true;
    end if;
    dT := ds*T/(-data.RH2O*g.tau*g.tau*g.gtautau);
    T := T - dT;
    i := i + 1;
  end while;
  if not found then
    error := 1;
  end if;
  assert(error &lt;&gt; 1,
    &quot;error in inverse function tofpst5: iteration failed&quot;);
end tofpst5;</code></pre>
<hr />
<p><a href="http://www.3ds.com/">Automatically generated</a> Fri Nov 12 16:31:41 2010.</p>
</body>
</html>
