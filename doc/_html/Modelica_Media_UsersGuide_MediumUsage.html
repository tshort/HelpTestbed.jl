<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Modelica.Media.UsersGuide.MediumUsage</title>
</head>
<body>
<div id="header">
<h1 class="title">Modelica.Media.UsersGuide.MediumUsage</h1>
</div>
<h1 id="modelica.media.usersguide.mediumusage-modelica.media.usersguide.mediumusage"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="Modelica.Media.UsersGuide.MediumUsage" /> <a href="Modelica_Media_UsersGuide.html#Modelica.Media.UsersGuide">Modelica.Media.UsersGuide</a>.MediumUsage</h1>
<p>::</p>
<p>Content:</p>
<ol>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.BasicUsage">Basic usage of medium model</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.BalanceVolume">Medium model for a balance volume</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.ShortPipe">Medium model for a pressure loss</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.OptionalProperties">Optional medium properties</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.Constants">Constants provided by medium model</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.TwoPhase">Two-phase media</a></li>
<li><a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.Initialization">Initialization</a></li>
</ol>
<p>A good demonstration how to use the media from Modelica.Media is given in package Modelica.Media.Examples.Tests. Under <a href="Modelica_Media_Examples_Tests_Components.html#Modelica.Media.Examples.Tests.Components">Tests.Components</a> the most basic components of a Fluid library are defined. Under Tests.MediaTestModels these basic components are used to test all media models with some very simple piping networks.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<h2 id="package-content">Package Content</h2>
<table>
<col width="88%" />
<col width="11%" />
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image8" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.BasicUsage">BasicUsage</a></td>
<td align="left">Basic usage</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image9" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.BalanceVolume">BalanceVolume</a></td>
<td align="left">Balance volume</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image10" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.ShortPipe">ShortPipe</a></td>
<td align="left">Short pipe</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image11" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.OptionalProperties">OptionalProperties</a></td>
<td align="left">Optional properties</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image12" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.Constants">Constants</a></td>
<td align="left">Constants</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image13" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.TwoPhase">TwoPhase</a></td>
<td align="left">Two-phase media</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Media.UsersGuide.MediumUsage.BasicUsageS.png" alt="image14" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage.Initialization">Initialization</a></td>
<td align="left">Initialization</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="image15-modelica.media.usersguide.mediumusage.basicusage"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image15" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.BasicUsage</h1>
<p>::</p>
<h3 id="basic-usage-of-medium-model">Basic usage of medium model</h3>
<p>Media models in Modelica.Media are provided by packages, inheriting from the partial package Modelica.Media.Interfaces.PartialMedium. Every package defines:</p>
<ul>
<li>Medium <strong>constants</strong> (such as the number of chemical substances, molecular data, critical properties, etc.).</li>
<li>A BaseProperties <strong>model</strong>, to compute the basic thermodynamic properties of the fluid;</li>
<li><strong>setState_XXX</strong> functions to compute the thermodynamic state record from different input arguments (such as density, temperature, and composition which would be setState_dTX);</li>
<li><strong>Functions</strong> to compute additional properties (such as saturation properties, viscosity, thermal conductivity, etc.).</li>
</ul>
<p>There are - as stated above - two different basic ways of using the Media library which will be described in more details in the following section. One way is to use the model BaseProperties. Every instance of BaseProperties for any medium model provides <strong>3+nXi equations</strong> for the following <strong>5+nXi variables</strong> that are declared in the medium model (nXi is the number of independent mass fractions, see explanation below):</p>
<table>
<col width="16%" />
<col width="12%" />
<col width="71%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Variable</strong></td>
<td align="left"><strong>Unit</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">T</td>
<td align="left">K</td>
<td align="left">temperature</td>
</tr>
<tr class="odd">
<td align="left">p</td>
<td align="left">Pa</td>
<td align="left">absolute pressure</td>
</tr>
<tr class="even">
<td align="left">d</td>
<td align="left">kg/m3</td>
<td align="left">density</td>
</tr>
<tr class="odd">
<td align="left">u</td>
<td align="left">J/kg</td>
<td align="left">specific internal energy</td>
</tr>
<tr class="even">
<td align="left">h</td>
<td align="left">J/kg</td>
<td align="left">specific enthalpy (h = u + p/d)</td>
</tr>
<tr class="odd">
<td align="left">Xi[nXi]</td>
<td align="left">kg/kg</td>
<td align="left">independent mass fractions m_i/m</td>
</tr>
<tr class="even">
<td align="left">X[nX]</td>
<td align="left">kg/kg</td>
<td align="left"><dl>
<dt>All mass fractions m_i/m. X is defined in BaseProperties by:</dt>
<dd><p>X = <strong>if</strong> reducedX <strong>then</strong> vector([Xi; 1-<strong>sum</strong>(Xi)]) <strong>else</strong> Xi</p>
</dd>
</dl></td>
</tr>
</tbody>
</table>
<p><strong>Two</strong> variables out of p, d, h, or u, as well as the <strong>mass fractions</strong> Xi are the <strong>independent</strong> variables and the medium model basically provides equations to compute the remaining variables, including the full mass fraction vector X (more details to Xi and X are given further below).</p>
<p>In a component, the most basic usage of a medium model is as follows</p>
<pre><code>model Pump
  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                       &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);
  Medium.BaseProperties medium_a &quot;Medium properties at location a (e.g., port_a)&quot;;
  // Use medium variables (medium_a.p, medium_a.T, medium_a.h, ...)
   ...
end Pump;</code></pre>
<p>The second way is to use the setState_XXX functions to compute the thermodynamic state record from which all other thermodynamic state variables can be computed (see <a href="Modelica_Media_UsersGuide_MediumDefinition.html#Modelica.Media.UsersGuide.MediumDefinition.BasicDefinition">Basic definition of medium</a> for further details on ThermodynamicState). The setState_XXX functions accept either X or Xi (see explanation below) and will decide internally which of these two compositions is provided by the user. The four fundamental setState_XXX functions are provided in PartialMedium</p>
<table>
<col width="13%" />
<col width="65%" />
<col width="21%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Function</strong></td>
<td align="left"><strong>Description</strong></td>
<td align="left"><strong>Short-form for single component medium</strong></td>
</tr>
<tr class="even">
<td align="left">setState_dTX</td>
<td align="left">computes ThermodynamicState from density, temperature, and composition X or Xi</td>
<td align="left">setState_dT</td>
</tr>
<tr class="odd">
<td align="left">setState_phX</td>
<td align="left">computes ThermodynamicState from pressure, specific enthalpy, and composition X or Xi</td>
<td align="left">setState_ph</td>
</tr>
<tr class="even">
<td align="left">setState_psX</td>
<td align="left">computes ThermodynamicState from pressure, specific entropy, and composition X or Xi</td>
<td align="left">setState_ps</td>
</tr>
<tr class="odd">
<td align="left">setState_pTX</td>
<td align="left">computes ThermodynamicState from pressure, temperature, and composition X or Xi</td>
<td align="left">setState_pT</td>
</tr>
</tbody>
</table>
<p>The simple example that explained the basic usage of BaseProperties would then become</p>
<pre><code>model Pump
  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                       &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);
  Medium.ThermodynamicState state_a &quot;Thermodynamic state record at location a (e.g., port_a)&quot;;
  // Compute medium variables from thermodynamic state record (pressure(state_a), temperature(state_a),
  // specificEnthalpy(state_a), ...)
  ...
end Pump;</code></pre>
<p>All media models are directly or indirectly a subpackage of package Modelica.Media.Interfaces.PartialMedium. Therefore, a medium model in a component should inherit from this partial package. Via the annotation &quot;__Dymola_choicesAllMatching = true&quot; it is defined that the tool should display a selection box with all loaded packages that inherit from PartialMedium. An example is given in the next figure:</p>
<p>A selected medium model leads, e.g., to the following equation:</p>
<pre><code>Pump pump(redeclare package Medium = Modelica.Media.Water.SimpleLiquidWater);</code></pre>
<p>Usually, a medium model is associated with the variables of a fluid connector. Therefore, equations have to be defined in a model that relate the variables in the connector with the variables in the medium model:</p>
<pre><code>model Pump
  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                       &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);
  Medium.BaseProperties medium_a &quot;Medium properties of port_a&quot;;
  // definition of the fluid port port_a
   ...
equation
  medium.p = port_a.p;
  medium.h = port_a.h;
  medium.Xi = port_a.Xi;
   ...
end Pump;</code></pre>
<p>in the case of using BaseProperties or</p>
<pre><code>model Pump
  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                       &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);
  Medium.ThermodynamicState state_a &quot;Thermodynamic state record of medium at port_a&quot;;
  // definition of the fluid port port_a
   ...
equation
  state_a = Medium.setState_phX(port_a.p, port_a.h, port_a.Xi) // if port_a contains the variables
                                                               // p, h, and Xi
   ...
end Pump;</code></pre>
<p>in the case of using ThermodynamicState.</p>
<p>If a component model shall treat both single and multiple substance fluids, equations for the mass fractions have to be present (above: medium.Xi = port_a.Xi) in the model. According to the Modelica semantics, the equations of the mass fractions are ignored, if the dimension of Xi is zero, i.e., for a single-component medium. Note, by specific techniques sketched in section &quot;Medium definition&quot;, the independent variables in the medium model need not to be the same as the variables in the connector and still get the same efficiency, as if the same variables would be used.</p>
<p>If a fluid consists of a single substance, <strong>nXi = 0</strong> and the vector of mass fractions Xi is not present. If a fluid consists of nS substances, the medium model may define the number of independent mass fractions <strong>nXi</strong> to be <strong>nS</strong>, <strong>nS-1</strong>, or zero. In all cases, balance equations for nXi substances have to be given in the corresponding component (see discussion below). Note, that if nXi = nS, the constraint &quot;sum(Xi)=1&quot; between the mass fractions is <strong>not</strong> present in the model; in that case, it is necessary to provide consistent start values for Xi such that sum(Xi) = 1.</p>
<p>The reason for this definition of Xi is that a fluid component library can be implemented by using only the independent mass fractions Xi and then via the medium it is defined how Xi is interpreted:</p>
<ul>
<li>If Xi = nS, then the constraint equation sum(X) = 1 is neglected during simulation. By making sure that the initial conditions of X fulfill this constraint, it can usually be guaranteed that small errors in sum(X) = 1 remain small although this constraint equation is not explicitly used during the simulation. This approach is usually useful if components of the mixture can become very small. If such a small quantity is computed via the equation 1 -sum(X[1:nX-1]), there might be large numerical errors and it is better to compute it via the corresponding balance equation.</li>
<li>If Xi = nS-1, then the true independent mass fractions are used in the fluid component and the last component of X is computed via X[nX] = 1 - sum(Xi). This is useful for, e.g., MoistAir, where the number of states should be as small as possible without introducing numerical problems.</li>
<li>If Xi = 0, then the reference value of composition reference_X is assumed. This case is useful to avoid composition states in all the cases when the composition will always be constant, e.g., with circuits having fixed composition sources.</li>
</ul>
<p>The full vector of mass fractions <strong>X[nX]</strong> is computed in PartialMedium.BaseProperties based on Xi, reference_X, and the information whether Xi = nS or nS-1. For single-substance media, nX = 0, so there's also no X vector. For multiple-substance media, nX = nS, and X always contains the full vector of mass fractions. In order to reduce confusion for the user of a fluid component library, &quot;Xi&quot; has the annotation &quot;HideResult=true&quot;, meaning, that this variable is not shown in the plot window. Only X is shown in the plot window and this vector always contains all mass fractions.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image16-modelica.media.usersguide.mediumusage.balancevolume"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image16" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.BalanceVolume</h1>
<p>::</p>
<p>Fluid libraries usually have balance volume components with one fluid connector port that fulfill the mass and energy balance and on a different grid components that fulfill the momentum balance. A balance volume component, called junction volume below, should be primarily implemented in the following way (see also the implementation in <a href="Modelica_Media_Examples_Tests_Components.html#Modelica.Media.Examples.Tests.Components.PortVolume">Modelica.Media.Examples.Tests.Components.PortVolume</a>):</p>
<pre><code>model JunctionVolume
  import SI=Modelica.SIunits;
  import Modelica.Media.Examples.Tests.Components.FluidPort_a;

  parameter SI.Volume V = 1e-6 &quot;Fixed size of junction volume&quot;;
  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                         &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);

  FluidPort_a port(redeclare package Medium = Medium);
  Medium.BaseProperties medium(preferredMediumStates = true);

  SI.Energy U               &quot;Internal energy of junction volume&quot;;
  SI.Mass   M               &quot;Mass of junction volume&quot;;
  SI.Mass   MX[Medium.nXi] &quot;Independent substance masses of junction volume&quot;;
equation
  medium.p   = port.p;
  medium.h   = port.h;
  medium.Xi = port.Xi;

  M  = V*medium.d;                  // mass of JunctionVolume
  MX = M*medium.Xi;                // mass fractions in JunctionVolume
  U  = M*medium.u;                  // internal energy in JunctionVolume

  der(M)  = port.m_flow;    // mass balance
  der(MX) = port.mX_flow;   // substance mass balance
  der(U)  = port.H_flow;    // energy balance
end JunctionVolume;</code></pre>
<p>Assume the Modelica.Media.Air.SimpleAir medium model is used with the JunctionVolume model above. This medium model uses pressure p and temperature T as independent variables. If the flag &quot;preferredMediumStates&quot; is set to <strong>true</strong> in the declaration of &quot;medium&quot;, then the independent variables of this medium model get the attribute &quot;stateSelect = StateSelect.prefer&quot;, i.e., the Modelica translator should use these variables as states, if this is possible. Basically, this means that constraints between the potential states p,T and the potential states U,M are present. A Modelica tool will therefore <strong>automatically</strong> differentiate medium equations and will use the following equations for code generation (note the equations related to X are removed, because SimpleAir consists of a single substance only):</p>
<pre><code>M  = V*medium.d;
U  = M*medium.u;

// balance equations
der(M)  = port.m_flow;
der(U)  = port.H_flow;

// abbreviations introduced to get simpler terms
p = medium.p;
T = medium.T;
d = medium.d;
u = medium.u;
h = medium.h;

// medium equations
d = fd(p,T);
h = fh(p,T);
u = h - p/d;

// equations derived automatically by a Modelica tool due to index reduction
der(U) = der(M)*u + M*der(u);
der(M) = V*der(d);
der(u) = der(h) - der(p)/d - p/der(d);
der(d) = der(fd,p)*der(p) + der(fd,T)*der(T);
der(h) = der(fh,p)*der(p) + der(fd,T)*der(T);</code></pre>
<p>Note, that &quot;der(y,x)&quot; is an operator that characterizes in the example above the partial derivative of y with respect to x (this operator will be included in one of the next Modelica language releases). All media models in this library are written in such a way that at least the partial derivatives of the medium variables with respect to the independent variables are provided, either because the equations are directly given (= symbolic differentiation is possible) or because the derivative of the corresponding function (such as fd above) is provided. A Modelica tool will transform the equations above in differential equations with p and T as states, i.e., will generate equations to compute <strong>der</strong>(p) and <strong>der</strong>(T) as function of p and T.</p>
<p>Note, when preferredMediumStates = <strong>false</strong>, no differentiation will take place and the Modelica translator will use the variables appearing differentiated as states, i.e., M and U. This has the disadvantage that for many media non-linear systems of equations are present to compute the intrinsic properties p, d, T, u, h from M and U.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image17-modelica.media.usersguide.mediumusage.shortpipe"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image17" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.ShortPipe</h1>
<p>::</p>
<p>Fluid libraries have components with two ports that store neither mass nor energy and fulfill the momentum equation between their two ports, e.g., a short pipe. In most cases this means that an equation is present relating the pressure drop between the two ports and the mass flow rate from one to the other port. Since no mass or energy is stored, no differential equations for thermodynamic variables are present. A component model of this type has therefore usually the following structure (see also the implementation in <a href="Modelica_Media_Examples_Tests_Components.html#Modelica.Media.Examples.Tests.Components.ShortPipe">Modelica.Media.Examples.Tests.Components.ShortPipe</a>):</p>
<pre><code>model ShortPipe
  import SI=Modelica.SIunits;
  import Modelica.Media.Examples.Tests.Components;

  // parameters defining the pressure drop equation

  replaceable package Medium = Modelica.Media.Interfaces.PartialMedium
                         &quot;Medium model&quot; annotation (__Dymola_choicesAllMatching = true);

  Component.FluidPort_a port_a (redeclare package Medium = Medium);
  Component.FluidPort_b port_b (redeclare package Medium = Medium);

  SI.Pressure dp = port_a.p - port_b.p &quot;Pressure drop&quot;;
  Medium.BaseProperties medium_a &quot;Medium properties in port_a&quot;;
  Medium.BasePropreties medium_b &quot;Medium properties in port_b&quot;;
equation
  // define media models of the ports
  medium_a.p   = port_a.p;
  medium_a.h   = port_a.h;
  medium_a.Xi = port_a.Xi;

  medium_b.p   = port_b.p;
  medium_b.h   = port_b.h;
  medium_b.Xi = port_b.Xi;

  // Handle reverse and zero flow (semiLinear is a built-in Modelica operator)
  port_a.H_flow   = semiLinear(port_a.m_flow, port_a.h, port_b.h);
  port_a.mXi_flow = semiLinear(port_a.m_flow, port_a.Xi, port_b.Xi);

  // Energy, mass and substance mass balance
  port_a.H_flow + port_b.H_flow = 0;
  port_a.m_flow + port_b.m_flow = 0;
  port_a.mXi_flow + port_b.mXi_flow = zeros(Medium.nXi);

  // Provide equation: port_a.m_flow = f(dp)
end ShortPipe;</code></pre>
<p>The <strong>semiLinear</strong>(..) operator is basically defined as:</p>
<pre><code>semiLinear(m_flow, ha, hb) = if m_flow â‰¥ 0 then m_flow*ha else m_flow*hb;</code></pre>
<p>that is, it computes the enthalpy flow rate either from the port_a or from the port_b properties, depending on flow direction. The exact details of this operator are given in <a href="../../ModelicaReference/help/ModelicaReference_Operators.html#ModelicaReference.Operators.SemiLinear">ModelicaReference.Operators.SemiLinear</a>. Especially, rules are defined in the Modelica specification that m_flow = 0 can be treated in a &quot;meaningful way&quot;. Especially, if n fluid components (such as pipes) are connected together and the fluid connector from above is used, a linear system of equations appear between medium1.h, medium2.h, medium3.h, ..., port1.h, port2.h, port3.h, ..., port1.H_flow, port2.H_flow, port3.H_flow, .... The rules for the semiLinear(..) operator allow the following solution of this linear system of equations:</p>
<ul>
<li><dl>
<dt>n = 2 (two components are connected):</dt>
<dd><p>The linear system of equations can be analytically solved with the</p>
</dd>
</dl>
<p>result</p>
<pre><code>medium1.h = medium2.h = port1.h = port2.h
0 = port1.H_flow + port2.H_flow</code></pre>
<p>Therefore, no problems with zero mass flow rate are present.</p></li>
<li><dl>
<dt>n &gt; 2 (more than two components are connected together):</dt>
<dd><p>The linear system of equations is solved numerically during</p>
</dd>
</dl>
<p>simulation. For m_flow = 0, the linear system becomes singular and has an infinite number of solutions. The simulator could use the solution t that is closest to the solution in the previous time step (&quot;least squares solution&quot;). Physically, the solution is determined by diffusion which is usually neglected. If diffusion is included, the linear system is regular.</p></li>
</ul>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image18-modelica.media.usersguide.mediumusage.optionalproperties"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image18" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.OptionalProperties</h1>
<p>::</p>
<p>In some cases additional medium properties are needed. A component that needs these optional properties has to call one of the functions listed in the following table. They are defined as partial functions within package <a href="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium">PartialMedium</a>, and then (optionally) implemented in actual medium packages. If a component calls such an optional function and the medium package does not provide a new implementation for this function, an error message is printed at translation time, since the function is &quot;partial&quot;, i.e., incomplete. The argument of all functions is the <strong>state</strong> record, automatically defined by the BaseProperties model or specifically computed using the setState_XXX functions, which contains the minimum number of thermodynamic variables needed to compute all the additional properties. In the table it is assumed that there is a declaration of the form:</p>
<pre><code>replaceable package Medium = Modelica.Media.Interfaces.PartialMedium;
Medium.ThermodynamicState state;</code></pre>
<table>
<col width="38%" />
<col width="12%" />
<col width="49%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Function call</strong></td>
<td align="left"><strong>Unit</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">Medium.dynamicViscosity(state)</td>
<td align="left">Pa.s</td>
<td align="left">dynamic viscosity</td>
</tr>
<tr class="odd">
<td align="left">Medium.thermalConductivity(state)</td>
<td align="left">W/(m.K)</td>
<td align="left">thermal conductivity</td>
</tr>
<tr class="even">
<td align="left">Medium.prandtlNumber(state)</td>
<td align="left">1</td>
<td align="left">Prandtl number</td>
</tr>
<tr class="odd">
<td align="left">Medium.specificEntropy(state)</td>
<td align="left">J/(kg.K)</td>
<td align="left">specific entropy</td>
</tr>
<tr class="even">
<td align="left">Medium.specificHeatCapacityCp(state)</td>
<td align="left">J/(kg.K)</td>
<td align="left">specific heat capacity at constant pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.specificHeatCapacityCv(state)</td>
<td align="left">J/(kg.K)</td>
<td align="left">specific heat capacity at constant density</td>
</tr>
<tr class="even">
<td align="left">Medium.isentropicExponent(state)</td>
<td align="left">1</td>
<td align="left">isentropic exponent</td>
</tr>
<tr class="odd">
<td align="left">Medium.isentropicEnthatlpy(pressure, state)</td>
<td align="left">J/kg</td>
<td align="left">isentropic enthalpy</td>
</tr>
<tr class="even">
<td align="left">Medium.velocityOfSound(state)</td>
<td align="left">m/s</td>
<td align="left">velocity of sound</td>
</tr>
<tr class="odd">
<td align="left">Medium.isobaricExpansionCoefficient(state)</td>
<td align="left">1/K</td>
<td align="left">isobaric expansion coefficient</td>
</tr>
<tr class="even">
<td align="left">Medium.isothermalCompressibility(state)</td>
<td align="left">1/Pa</td>
<td align="left">isothermal compressibility</td>
</tr>
<tr class="odd">
<td align="left">Medium.density_derp_h(state)</td>
<td align="left">kg/(m3.Pa)</td>
<td align="left">derivative of density by pressure at constant enthalpy</td>
</tr>
<tr class="even">
<td align="left">Medium.density_derh_p(state)</td>
<td align="left">kg2/(m3.J)</td>
<td align="left">derivative of density by enthalpy at constant pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.density_derp_T(state)</td>
<td align="left">kg/(m3.Pa)</td>
<td align="left">derivative of density by pressure at constant temperature</td>
</tr>
<tr class="even">
<td align="left">Medium.density_derT_p(state)</td>
<td align="left">kg/(m3.K)</td>
<td align="left">derivative of density by temperature at constant pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.density_derX(state)</td>
<td align="left">kg/m3</td>
<td align="left">derivative of density by mass fraction</td>
</tr>
<tr class="even">
<td align="left">Medium.molarMass(state)</td>
<td align="left">kg/mol</td>
<td align="left">molar mass</td>
</tr>
</tbody>
</table>
<p>There are also some short forms provided for user convenience that allow the computation of certain thermodynamic state variables without using the ThermodynamicState record explicitly. Those short forms are for example useful to compute consistent start values in the initial equation section. Let's consider the function temperature_phX(p,h,X) as an exmaple. This function computes the temperature from pressure, specific enthalpy, and composition X (or Xi) and is a short form for writing</p>
<pre><code>temperature(setState_phX(p,h,X))</code></pre>
<p>The following functions are predefined in PartialMedium (other functions can be added in the actual medium implementation package if they are useful)</p>
<table>
<col width="46%" />
<col width="15%" />
<col width="38%" />
<tbody>
<tr class="odd">
<td align="left">Medium.specificEnthalpy_pTX(p,T,X)</td>
<td align="left">J/kg</td>
<td align="left">Specific enthalpy at p, T, X</td>
</tr>
<tr class="even">
<td align="left">Medium.temperature_phX(p,h,X)</td>
<td align="left">K</td>
<td align="left">Temperature at p, h, X</td>
</tr>
<tr class="odd">
<td align="left">Medium.density_phX(p,h,X)</td>
<td align="left">kg/m3</td>
<td align="left">Density at p, h, X</td>
</tr>
<tr class="even">
<td align="left">Medium.temperature_psX(p,s,X)</td>
<td align="left">K</td>
<td align="left">Temperature at p, s, X</td>
</tr>
<tr class="odd">
<td align="left">Medium.specificEnthalpy_psX(p,s,X)</td>
<td align="left">J/(kg.K)</td>
<td align="left">Specific entropy at p, s, X</td>
</tr>
</tbody>
</table>
<p>Assume for example that the dynamic viscosity eta is needed in the pressure drop equation of a short pipe. Then, the model of a short pipe has to be changed to:</p>
<pre><code>model ShortPipe
    ...
  Medium.BaseProperties medium_a &quot;Medium properties in port_a&quot;;
  Medium.BaseProperties medium_b &quot;Medium properties in port_b&quot;;
    ...
  Medium.DynamicViscosity eta;
    ...
  eta = if port_a.m_flow &gt; 0 then
             Medium.dynamicViscosity(medium_a.state)
        else
             Medium.dynamicViscosity(medium_b.state);
  // use eta in the pressure drop equation: port_a.m_flow = f(dp, eta)
end ShortPipe;</code></pre>
<p>Note, &quot;Medium.DynamicViscosity&quot; is a type defined in Modelica.Interfaces.PartialMedium as</p>
<pre><code>import SI = Modelica.SIunits;
type DynamicViscosity = SI.DynamicViscosity (
                                   min=0,
                                   max=1.e8,
                                   nominal=1.e-3,
                                   start=1.e-3);</code></pre>
<p>Every medium model may modify the attributes, to provide, e.g., min, max, nominal, and start values adapted to the medium. Also, other types, such as AbsolutePressure, Density, MassFlowRate, etc. are defined in PartialMedium. Whenever possible, these medium specific types should be used in a model in order that medium information, e.g., about nominal or start values, are automatically utilized.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image19-modelica.media.usersguide.mediumusage.constants"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image19" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.Constants</h1>
<p>::</p>
<p>Every medium model provides the following <strong>constants</strong>. For example, if a medium is declared as:</p>
<pre><code>replaceable package Medium = Modelica.Media.Interfaces.PartialMedium;</code></pre>
<p>then constants &quot;Medium.mediumName&quot;, &quot;Medium.nX&quot;, etc. are defined:</p>
<table>
<col width="4%" />
<col width="5%" />
<col width="89%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Type</strong></td>
<td align="left"><strong>Name</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">String</td>
<td align="left">mediumName</td>
<td align="left">Unique name of the medium (is usually used to check whether the media in different components connected together are the same, by providing Medium.mediumName as quantity attribute of the mass flow rate in the connector)</td>
</tr>
<tr class="odd">
<td align="left">String</td>
<td align="left">substanceNames[nS]</td>
<td align="left">Names of the substances that make up the medium. If only one substance is present, substanceNames = {mediumName}.</td>
</tr>
<tr class="even">
<td align="left">String</td>
<td align="left">extraPropertiesNames[nC]</td>
<td align="left">Names of the extra transported substances, outside of mass and energy balances.</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">singleState</td>
<td align="left">= <strong>true</strong>, if u and d are not a function of pressure, and thus only a function of a single thermal variable (temperature or enthalpy) and of Xi for a multiple substance medium. Usually, this flag is <strong>true</strong> for incompressible media. It is used in a model to determine whether 1+nXi (singleState=<strong>true</strong>) or 2+nXi (singleState=<strong>false</strong>) initial conditions have to be provided for a volume element that contains mass and energy balance.</td>
</tr>
<tr class="even">
<td align="left">AbsolutePressure</td>
<td align="left">reference_p</td>
<td align="left">Reference pressure for the medium</td>
</tr>
<tr class="odd">
<td align="left">MassFraction</td>
<td align="left">reference_X[nX]</td>
<td align="left">Reference composition for the medium</td>
</tr>
<tr class="even">
<td align="left">AbsolutePressure</td>
<td align="left">p_default</td>
<td align="left">Default value for pressure of medium (for initialization)</td>
</tr>
<tr class="odd">
<td align="left">Temperature</td>
<td align="left">T_default</td>
<td align="left">Default value for temperature of medium (for initialization)</td>
</tr>
<tr class="even">
<td align="left">SpecificEnthalpy</td>
<td align="left">h_default</td>
<td align="left">Default value for specific enthalpy of medium (for initialization)</td>
</tr>
<tr class="odd">
<td align="left">MassFraction</td>
<td align="left">X_default[nX]</td>
<td align="left">Default value for mass fractions of medium (for initialization)</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">nS</td>
<td align="left">number of substances contained in the medium.</td>
</tr>
<tr class="odd">
<td align="left">Integer</td>
<td align="left">nX</td>
<td align="left">Size of the full mass fraction vector X nX=nS.</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">nXi</td>
<td align="left">Number of independent mass fractions. If there is a single substance, then nXi = 0.</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">reducedX</td>
<td align="left"><dl>
<dt>= <strong>true</strong>, if the medium has a single substance, or if the medium model has multiple substances and contains the equation sum(X) = 1. In both cases, nXi = nS - 1 (unless fixedX = true).</dt>
<dd><p>= <strong>false</strong>, if the medium has multiple substances and does not contain the equation sum(X)=1, i.e., nXi = nX = nS (unless fixedX = true).</p>
</dd>
</dl></td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">fixedX</td>
<td align="left"><dl>
<dt>= <strong>false</strong>: the composition of the medium can vary, and is determined by nXi independent mass fractions (see reducedX above).</dt>
<dd><p>= <strong>true</strong>: the composition of the medium is always reference_X, and nXi = 0.</p>
</dd>
</dl></td>
</tr>
<tr class="odd">
<td align="left">FluidConstants</td>
<td align="left">fluidConstants[nS]</td>
<td align="left">Critical, triple, molecular and other standard data that are provided for every substance of a medium.</td>
</tr>
</tbody>
</table>
<p>The record FluidConstants that is defined in PartialMedium contains the following elements</p>
<table>
<col width="14%" />
<col width="22%" />
<col width="63%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Type</strong></td>
<td align="left"><strong>Name</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">String</td>
<td align="left">iupacName</td>
<td align="left">complete IUPAC name</td>
</tr>
<tr class="odd">
<td align="left">String</td>
<td align="left">casRegistryNumber</td>
<td align="left">chemical abstracts sequencing number</td>
</tr>
<tr class="even">
<td align="left">String</td>
<td align="left">chemicalFormula</td>
<td align="left">Chemical formula, (brutto, nomenclature according to Hill)</td>
</tr>
<tr class="odd">
<td align="left">String</td>
<td align="left">structureFormula</td>
<td align="left">Chemical structure formula</td>
</tr>
<tr class="even">
<td align="left">MolarMass</td>
<td align="left">molarMass</td>
<td align="left">molar mass</td>
</tr>
</tbody>
</table>
<p>This record is extended in the partial packages further down the hierarchy (such as PartialTwoPhaseMedium or PartialMixtureMedium) and may contain some or all of the following elements</p>
<table>
<col width="15%" />
<col width="23%" />
<col width="61%" />
<tbody>
<tr class="odd">
<td align="left">Temperature</td>
<td align="left">criticalTemperature</td>
<td align="left">critical temperature</td>
</tr>
<tr class="even">
<td align="left">AbsolutePressure</td>
<td align="left">criticalPressure</td>
<td align="left">critical pressure</td>
</tr>
<tr class="odd">
<td align="left">MolarVolume</td>
<td align="left">criticalMolarVolume</td>
<td align="left">critical molar Volume</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">acentricFactor</td>
<td align="left">Pitzer acentric factor</td>
</tr>
<tr class="odd">
<td align="left">Temperature</td>
<td align="left">triplePointTemperature</td>
<td align="left">triple point temperature</td>
</tr>
<tr class="even">
<td align="left">AbsolutePressure</td>
<td align="left">triplePointPressure</td>
<td align="left">triple point pressure</td>
</tr>
<tr class="odd">
<td align="left">Temperature</td>
<td align="left">meltingPoint</td>
<td align="left">melting point at 101325 Pa</td>
</tr>
<tr class="even">
<td align="left">Temperature</td>
<td align="left">normalBoilingPoint</td>
<td align="left">normal boiling point (at 101325 Pa)</td>
</tr>
<tr class="odd">
<td align="left">DipoleMoment</td>
<td align="left">dipoleMoment</td>
<td align="left">dipole moment of molecule in Debye (1 debye = 3.33564e10-30 C.m)</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">hasIdealGasHeatCapacity</td>
<td align="left">true if ideal gas heat capacity is available</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">hasCriticalData</td>
<td align="left">true if critical data are known</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">hasDipoleMoment</td>
<td align="left">true if a dipole moment known</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">hasFundamentalEquation</td>
<td align="left">true if a fundamental equation</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">hasLiquidHeatCapacity</td>
<td align="left">true if liquid heat capacity is available</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">hasSolidHeatCapacity</td>
<td align="left">true if solid heat capacity is available</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">hasAccurateViscosityData</td>
<td align="left">true if accurate data for a viscosity function is available</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">hasAccurateConductivityData</td>
<td align="left">true if accurate data for thermal conductivity is available</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">hasVapourPressureCurve</td>
<td align="left">true if vapour pressure data, e.g., Antoine coefficents are known</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">hasAcentricFactor</td>
<td align="left">true if Pitzer accentric factor is known</td>
</tr>
<tr class="even">
<td align="left">SpecificEnthalpy</td>
<td align="left">HCRIT0</td>
<td align="left">Critical specific enthalpy of the fundamental equation</td>
</tr>
<tr class="odd">
<td align="left">SpecificEntropy</td>
<td align="left">SCRIT0</td>
<td align="left">Critical specific entropy of the fundamental equation</td>
</tr>
<tr class="even">
<td align="left">SpecificEnthalpy</td>
<td align="left">deltah</td>
<td align="left">Difference between specific enthalpy model (h_m) and f.eq. (h_f) (h_m - h_f)</td>
</tr>
<tr class="odd">
<td align="left">SpecificEntropy</td>
<td align="left">deltas</td>
<td align="left">Difference between specific enthalpy model (s_m) and f.eq. (s_f) (s_m - s_f)</td>
</tr>
</tbody>
</table>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image20-modelica.media.usersguide.mediumusage.twophase"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image20" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.TwoPhase</h1>
<p>::</p>
<p>Models for media which can exist in one-phase or two-phase conditions inherit from <a href="Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium">Modelica.Media.Interfaces.PartialTwoPhaseMedium</a> (which inherits from PartialMedium). The basic usage of these media models is the same as described in the previous sections. However, additional functionalities are provided, which apply only to potentially two-phase media.</p>
<p>The following additional medium <strong>constants</strong> are provided:</p>
<table>
<col width="4%" />
<col width="5%" />
<col width="90%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Type</strong></td>
<td align="left"><strong>Name</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">smoothModel</td>
<td align="left">If this flag is false (default value), then events are triggered whenever the saturation boundary is crossed; otherwise, no events are generated.</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">onePhase</td>
<td align="left">If this flag is true, then the medium model assumes it will be never called in the two-phase region. This can be useful to speed up the computations in a two-phase medium, when the user is sure it will always work in the one-phase region. Default value: false.</td>
</tr>
</tbody>
</table>
<p>The setState_ph(), setState_ps(), setState_dT() and setState_pT() functions have one extra input, named <em>phase</em>. If the phase input is not specified, or if it is given a value of zero, then the setState function will determine the phase, based on the other input values. An input phase = 1 will force the setState function to return a state vector corresponding to a one-phase state, while phase = 2 will force the setState value to return a state vector corresponding to a two-phase state, as shown in the following example;</p>
<pre><code>replaceable package Medium = Modelica.Media.Interfaces.PartialTwoPhaseMedium;
Medium.ThermodynamicState state, state1, state2;</code></pre>
<blockquote>
<dl>
<dt>equation</dt>
<dd><p>// Set the state, given the pressure and the specific enthalpy // the phase is determined by the (p, h) values, and can be retrieved // from the state record state = Medium.setState_ph(p, h); phase = state1.phase;</p>
<p>// Force the computation of the state with one-phase // equations of state, irrespective of the (p, h) values state1 = Medium.setState_ph(p, h, 1);</p>
<p>// Force the computation of the state with 2-phase // equations of state, irrespective of the (p, h) values state2 = Medium.setState_ph(p, h, 2);</p>
</dd>
</dl>
</blockquote>
<p>This feature can be used for the following purposes:</p>
<ul>
<li>saving computational time, if one knows in advance the phase of the medium;</li>
<li>unambiguously determine the phase, when the two inputs correspond to a point on the saturation boundary (the derivative functions have substantially different values on either side);</li>
<li>get the properties of metastable states, like superheated water or subcooled vapour.</li>
</ul>
<p>Many additional optional functions are defined to compute properties of saturated media, either liquid (bubble point) or vapour (dew point). The argument to such functions is a SaturationProperties record, which can be set starting from either the saturation pressure or the saturation temperature, as shown in the following example.</p>
<pre><code>replaceable package Medium = Modelica.Media.Interfaces.PartialTwoPhaseMedium;
Medium.SaturationProperties sat_p;
Medium.SaturationProperties sat_T;</code></pre>
<blockquote>
<dl>
<dt>equation</dt>
<dd><p>// Set sat_p to saturation properties at pressure p sat_p = Medium.setSat_p(p);</p>
<p>// Compute saturation properties at pressure p saturationTemperature_p = Medium.saturationTemperature_sat(sat_p); bubble_density_p = Medium.bubbleDensity(sat_p); dew_enthalpy_p = Medium.dewEnthalpy(sat_p);</p>
<p>// Set sat_T to saturation properties at temperature T sat_T = Medium.setSat_T(T);</p>
<p>// Compute saturation properties at temperature T saturationTemperature_T = Medium.saturationPressure_sat(sat_T); bubble_density_T = Medium.bubbleDensity(sat_T); dew_enthalpy_T = Medium.dewEnthalpy(sat_T);</p>
</dd>
</dl>
</blockquote>
<p>With reference to a model defining a pressure p, a temperature T, and a SaturationProperties record sat, the following functions are provided:</p>
<table>
<col width="34%" />
<col width="10%" />
<col width="54%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Function call</strong></td>
<td align="left"><strong>Unit</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">Medium.saturationPressure(T)</td>
<td align="left">Pa</td>
<td align="left">Saturation pressure at temperature T</td>
</tr>
<tr class="odd">
<td align="left">Medium.saturationTemperature(p)</td>
<td align="left">K</td>
<td align="left">Saturation temperature at pressure p</td>
</tr>
<tr class="even">
<td align="left">Medium.saturationTemperature_derp(p)</td>
<td align="left">K/Pa</td>
<td align="left">Derivative of saturation temperature with respect to pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.saturationTemperature_sat(sat)</td>
<td align="left">K</td>
<td align="left">Saturation temperature</td>
</tr>
<tr class="even">
<td align="left">Medium.saturationPressure_sat(sat)</td>
<td align="left">Pa</td>
<td align="left">Saturation pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.bubbleEnthalpy(sat)</td>
<td align="left">J/kg</td>
<td align="left">Specific enthalpy at bubble point</td>
</tr>
<tr class="even">
<td align="left">Medium.dewEnthalpy(sat)</td>
<td align="left">J/kg</td>
<td align="left">Specific enthalpy at dew point</td>
</tr>
<tr class="odd">
<td align="left">Medium.bubbleEntropy(sat)</td>
<td align="left">J/(kg.K)</td>
<td align="left">Specific entropy at bubble point</td>
</tr>
<tr class="even">
<td align="left">Medium.dewEntropy(sat)</td>
<td align="left">J/(kg.K)</td>
<td align="left">Specific entropy at dew point</td>
</tr>
<tr class="odd">
<td align="left">Medium.bubbleDensity(sat)</td>
<td align="left">kg/m3</td>
<td align="left">Density at bubble point</td>
</tr>
<tr class="even">
<td align="left">Medium.dewDensity(sat)</td>
<td align="left">kg/m3</td>
<td align="left">Density at dew point</td>
</tr>
<tr class="odd">
<td align="left">Medium.saturationTemperature_derp_sat(sat)</td>
<td align="left">K/Pa</td>
<td align="left">Derivative of saturation temperature with respect to pressure</td>
</tr>
<tr class="even">
<td align="left">Medium.dBubbleDensity_dPressure(sat)</td>
<td align="left">kg/(m3.Pa)</td>
<td align="left">Derivative of density at bubble point with respect to pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.dDewDensity_dPressure(sat)</td>
<td align="left">kg/(m3.Pa)</td>
<td align="left">Derivative of density at dew point with respect to pressure</td>
</tr>
<tr class="even">
<td align="left">Medium.dBubbleEnthalpy_dPressure(sat)</td>
<td align="left">J/(kg.Pa)</td>
<td align="left">Derivative of specific enthalpy at bubble point with respect to pressure</td>
</tr>
<tr class="odd">
<td align="left">Medium.dDewEnthalpy_dPressure(sat)</td>
<td align="left">J/(kg.Pa)</td>
<td align="left">Derivative of specific enthalpy at dew point with respect to pressure</td>
</tr>
<tr class="even">
<td align="left">Medium.surfaceTension(sat)</td>
<td align="left">N/m</td>
<td align="left">Surface tension between liquid and vapour phase</td>
</tr>
</tbody>
</table>
<p>Sometimes it can be necessary to compute fluid properties in the thermodynamic plane, just inside or outside the saturation dome. In this case, it is possible to obtain an instance of a ThermodynamicState state vector, and then use it to call the additional functions already defined for one-phase media.</p>
<table>
<col width="17%" />
<col width="82%" />
<tbody>
<tr class="odd">
<td align="left"><strong>Function call</strong></td>
<td align="left"><strong>Description</strong></td>
</tr>
<tr class="even">
<td align="left">Medium.setBubbleState(sat, phase)</td>
<td align="left">Obtain the thermodynamic state vector corresponding to the bubble point. If phase==1 (default), the state is on the one-phase side; if phase==2, the state is on the two-phase side</td>
</tr>
<tr class="odd">
<td align="left">Medium.setDewState(sat, phase)</td>
<td align="left">Obtain the thermodynamic state vector corresponding to the dew point. If phase==1 (default), the state is on the one-phase side; if phase==2, the state is on the two-phase side</td>
</tr>
</tbody>
</table>
<p>Here are some examples:</p>
<pre><code>replaceable package Medium = Modelica.Media.Interfaces.PartialTwoPhaseMedium;
Medium.SaturationProperties sat;
Medium.ThermodynamicState   dew_1;    // dew point, one-phase side
Medium.ThermodynamicState   bubble_2; // bubble point, two phase side</code></pre>
<blockquote>
<dl>
<dt>equation</dt>
<dd><p>// Set sat to saturation properties at pressure p sat = setSat_p(p);</p>
<p>// Compute dew point properties, (default) one-phase side dew_1 = setDewState(sat); cpDew = Medium.specificHeatCapacityCp(dew_1); drho_dp_h_1 = Medium.density_derp_h(dew_1);</p>
<p>// Compute bubble point properties, two-phase side bubble_2 = setBubbleState(sat, 2); drho_dp_h_2 = Medium.density_derp_h(bubble_2);</p>
</dd>
</dl>
</blockquote>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<h1 id="image21-modelica.media.usersguide.mediumusage.initialization"><img src="Modelica.Media.UsersGuide.MediumUsageI.png" alt="image21" /> <a href="Modelica_Media_UsersGuide_MediumUsage.html#Modelica.Media.UsersGuide.MediumUsage">Modelica.Media.UsersGuide.MediumUsage</a>.Initialization</h1>
<p>::</p>
<p>When a medium model is used in a balance volume, differential equations for the independent medium variables are present and therefore initial conditions have to be provided. The following possibilities exist:</p>
<h3 id="steady-state-initialization">Steady state initialization</h3>
<p>Modelica has currently no language element to define steady state initialization. In the Modelica simulation environment Dymola, the option</p>
<pre><code>Advanced.DefaultSteadyStateInitialization = true</code></pre>
<p>can be set before translation. Then, missing initial conditions are provided by automamtically setting appropriate state derivatives to zero.</p>
<h3 id="explicit-start-values-or-initial-equations">Explicit start values or initial equations</h3>
<p>Explicit start values can be defined with the &quot;start&quot; and &quot;fixed&quot; attributes. The number of independent variables nx need to be known which can be deduced from the medium constants (nx = nXi + <strong>if</strong> singleState <strong>then</strong> 1 <strong>else</strong> 2). Then, start values or initial equations can be defined for nx variables (= p, T, d, u, h, Xi) from Medium.BaseProperties, e.g., in the form:</p>
<pre><code>replaceable package Medium = Medium.Interfaces.PartialMedium;
Medium.BaseProperties medium1 (p(start=1e5, fixed=not Medium.singleState),
                               T(start=300, fixed=true));
Medium.BaseProperties medium2;</code></pre>
<blockquote>
<dl>
<dt>initial equation</dt>
<dd><dl>
<dt>if not Medium.singleState then</dt>
<dd><p>medium2.p = 1e5;</p>
</dd>
</dl>
<p>end if; medium2.T = 300;</p>
</dd>
</dl>
<p>equation</p>
</blockquote>
<p>If initial conditions are not provided for the independent medium variables, non-linear systems of equations may occur to compute the initial values of the independent medium variables from the provided initial conditions.</p>
<h3 id="guess-values">Guess values</h3>
<p>If non-linear systems of equations occur during initialization, e.g., in case of steady state initialization, guess values for the iteration variables of the non-linear system of equations have to be provided via the &quot;start&quot; attribute (and fixed=false). Unfortunately, it is usually not known in advance which variables are selected as iteration variables of a non-linear system of equations. One of the following possibilies exist:</p>
<ul>
<li>Do not supply start values and hope that the medium specific types have meaningful start values, such as in &quot;Medium.AbsolutePressure&quot;</li>
<li>Supply start values on all variables of the BaseProperties model, i.e., on p, T, d, u, h, Xi.</li>
<li>Determine the iteration variables of the non-linear systems of equations and provide start values for these variables. In the Modelica simulation environment Dymola, the iteration variables can be determined by setting the command <code>Advanced.OutputModelicaCode = true</code> and by inspection of the file &quot;dsmodel.mof&quot; that is generated when this option is set (search for &quot;nonlinear&quot;).</li>
</ul>
<p>::</p>
<p>Extends from <a href="Modelica_Icons.html#Modelica.Icons.Information">Modelica.Icons.Information</a> (Icon for general information packages).</p>
<hr />
<p><a href="http://www.3ds.com/">Automatically generated</a> Fri Nov 12 16:31:25 2010.</p>
</body>
</html>
