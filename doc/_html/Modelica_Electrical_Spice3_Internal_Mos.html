<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Modelica.Electrical.Spice3.Internal.Mos</title>
</head>
<body>
<div id="header">
<h1 class="title">Modelica.Electrical.Spice3.Internal.Mos</h1>
</div>
<h1 id="modelica.electrical.spice3.internal.mos"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal">Modelica.Electrical.Spice3.Internal</a>.Mos</h1>
<p><strong>Records and functions for Mosfets level 1,2,3,6</strong></p>
<h2 id="information">Information</h2>
<p>::</p>
<p>This package Mos contains functions and records with data of the mosfet models level 1, 2, 3 and 6.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons_Package.html#Modelica.Icons.Package">Modelica.Icons.Package</a> (Icon for standard packages).</p>
<h2 id="package-content">Package Content</h2>
<table>
<col width="76%" />
<col width="23%" />
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParamsS.png" alt="image12" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParams">MosModelLineParams</a></td>
<td align="left">Record for Mosfet model line parameters (for level 1, 2, 3 and 6)</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParamsS.png" alt="image13" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">Record for Mosfet model line variables (for level 1)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParamsS.png" alt="image14" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosCalc">MosCalc</a></td>
<td align="left">Further mosfet variables (for level 1, 2, 3 and 6)</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParamsS.png" alt="image15" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.DEVqmeyer">DEVqmeyer</a></td>
<td align="left">Meyer capacities and charge</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.MosModelLineParamsS.png" alt="image16" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.CurrrentsCapacitances">CurrrentsCapacitances</a></td>
<td align="left">Currents and Capacities</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image17" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquations">mosCalcInitEquations</a></td>
<td align="left">Mosfet initial precalculations (level 1)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image18" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mosCalcCalcTempDependencies">mosCalcCalcTempDependencies</a></td>
<td align="left">Precalculation relating to temperature</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image19" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mosCalcNoBypassCode">mosCalcNoBypassCode</a></td>
<td align="left">Calculation of currents and capacities (level 1)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image20" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mosCalcDEVqmeyer">mosCalcDEVqmeyer</a></td>
<td align="left">Calculation of meyer capacities</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image21" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mos2CalcInitEquations">mos2CalcInitEquations</a></td>
<td align="left">Mosfet initial precalculations (level 1)</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image22" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mos2CalcCalcTempDependencies">mos2CalcCalcTempDependencies</a></td>
<td align="left">Precalculation relating to temperature</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Mos.mosCalcInitEquationsS.png" alt="image23" /> <a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.mos2CalcNoBypassCode">mos2CalcNoBypassCode</a></td>
<td align="left">Calculation of currents and capacities (level 2)</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.mosmodellineparams"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.MosModelLineParams</h1>
<p><strong>Record for Mosfet model line parameters (for level 1, 2, 3 and 6)</strong></p>
<h2 id="information-1">Information</h2>
<p>::</p>
<p>This record MosModelLineParams contains the model line parameters that are used for the mosfet transistors level 1, 2, 3 and 6 in SPICE3.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.MosfetModelLineParams">Mosfet.MosfetModelLineParams</a> (Record for Mosfet model line parameters).</p>
<h2 id="parameters">Parameters</h2>
<table>
<col width="37%" />
<col width="21%" />
<col width="6%" />
<col width="34%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Initialization</td>
<td align="left">
</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_jctSatCurDensity.start</td>
<td align="left">0.0</td>
<td align="left">JS, Bulk jct. sat. current density, input - use tSatCurDens</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Resistance">Resistance</a></td>
<td align="left">m_sheetResistance.start</td>
<td align="left">0.0</td>
<td align="left">RSH, Sheet resistance [Ohm]</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_bulkJctPotential.start</td>
<td align="left">0.8</td>
<td align="left">PB, Bulk junction potential, input - use tBulkPot</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_bulkJctBotGradingCoeff.start</td>
<td align="left">0.5</td>
<td align="left">MJ, Bottom grading coefficient</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_bulkJctSideGradingCoeff.start</td>
<td align="left">0.5</td>
<td align="left">MJSW, Side grading coefficient</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_oxideThickness.start</td>
<td align="left">1.0e-7</td>
<td align="left">TOX, Oxide thickness unit: micron</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_gateSourceOverlapCapFactor.start</td>
<td align="left">0.0</td>
<td align="left">CGS0, Gate-source overlap cap</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_gateDrainOverlapCapFactor.start</td>
<td align="left">0.0</td>
<td align="left">CGD0, Gate-drain overlap cap</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_gateBulkOverlapCapFactor.start</td>
<td align="left">0.0</td>
<td align="left">CGB0, Gate-bulk overlap cap</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_fNcoef.start</td>
<td align="left">0.0</td>
<td align="left">KF, Flicker noise coefficient</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_fNexp.start</td>
<td align="left">1.0</td>
<td align="left">AF, Flicker noise exponent</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition">Modelica definition</h2>
<pre><code>record MosModelLineParams 
  &quot;Record for Mosfet model line parameters (for level 1, 2, 3 and 6)&quot;
  extends Mosfet.MosfetModelLineParams;

   Real m_oxideCapFactor(      start = 0.0);
   Modelica.SIunits.Voltage m_vt0(                 start = 0.0) 
    &quot;VTO, Threshold voltage&quot;;
   Real m_vtOIsGiven &quot;VTO IsGivenValue&quot;;
   Modelica.SIunits.Capacitance m_capBD(               start = 0.0) 
    &quot;CBD, B-D junction capacitance&quot;;
   Real m_capBDIsGiven &quot;CapBD IsGivenValue&quot;;
   Modelica.SIunits.Capacitance m_capBS(               start = 0.0) 
    &quot;CBS, B-S junction capacitance&quot;;
   Real m_capBSIsGiven &quot;CapBS IsGivenValue&quot;;
   Modelica.SIunits.CapacitancePerArea m_bulkCapFactor(       start = 0.0) 
    &quot;CJ, Bottom junction cap per area&quot;;
   Real m_bulkCapFactorIsGiven &quot;Bulk cap factor IsGivenValue&quot;;
   Modelica.SIunits.Permittivity m_sideWallCapFactor(   start = 0.0) 
    &quot;CJSW, Side grading coefficient&quot;;
   Real m_fwdCapDepCoeff(      start = 0.5) &quot;FC, Forward bias jct. fit parm.&quot;;
   Modelica.SIunits.Voltage m_phi(                 start = 0.6) 
    &quot;PHI, Surface potential&quot;;
   Real m_phiIsGiven &quot;Phi IsGivenValue&quot;;
   Modelica.SIunits.Voltage m_gamma(               start = 0.0) 
    &quot;GAMMA, Bulk threshold parameter&quot;;
   Real m_gammaIsGiven &quot;Gamma IsGivenValue&quot;;
   Modelica.SIunits.InversePotential m_lambda &quot;Channel-length modulation&quot;;
   Real m_substrateDoping(     start = 0.0) &quot;NSUB, Substrate doping&quot;;
   Real m_substrateDopingIsGiven &quot;Substrate doping IsGivenValue&quot;;
   Real m_gateType(            start = 1.0) &quot;TPG, Gate type&quot;;
   Modelica.SIunits.Conversions.NonSIunits.PerArea_cm
    m_surfaceStateDensity(                                                   start = 0.0) 
    &quot;NSS, Gate type&quot;;
   Real m_surfaceStateDensityIsGiven &quot;surfaceStateDensityIsGivenValue&quot;;
   Modelica.SIunits.Conversions.NonSIunits.Area_cmPerVoltageSecond
    m_surfaceMobility( start = 600.0) &quot;UO, Surface mobility&quot;;
   Modelica.SIunits.Length m_latDiff(             start = 0.0) 
    &quot;LD, Lateral diffusion&quot;;
   Modelica.SIunits.Current m_jctSatCur(           start = 1.0e-14) 
    &quot;IS, Bulk junction sat. current&quot;;
   Modelica.SIunits.Resistance m_drainResistance(     start = 0) 
    &quot;RD, Drain ohmic resistance&quot;;
   Real m_drainResistanceIsGiven &quot;Drain resistance IsGivenValue&quot;;
   Modelica.SIunits.Resistance m_sourceResistance(    start = 0) 
    &quot;RS, Source ohmic resistance&quot;;
   Real m_sourceResistanceIsGiven &quot;Source resistance IsGivenValue&quot;;
   Modelica.SIunits.Transconductance m_transconductance 
    &quot;input - use tTransconductance&quot;;
   Real m_transconductanceIsGiven &quot;Transconductance IsGivenValue&quot;;
   Modelica.SIunits.Temp_K m_tnom(start=SpiceConstants.CKTnomTemp) 
    &quot;TNOM, Parameter measurement temperature&quot;;

end MosModelLineParams;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.mosmodellinevariables"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.MosModelLineVariables</h1>
<p><strong>Record for Mosfet model line variables (for level 1)</strong></p>
<h2 id="information-2">Information</h2>
<p>::</p>
<p>This record MosModelLineVariables contains the model line variables that are used for the mosfet transistors level 1 SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition-1">Modelica definition</h2>
<pre><code>record MosModelLineVariables 
  &quot;Record for Mosfet model line variables (for level 1)&quot;

  Real m_oxideCapFactor;
  Modelica.SIunits.Voltage m_vt0;
  Modelica.SIunits.Voltage m_phi;
  Real m_gamma;
  Modelica.SIunits.Transconductance m_transconductance;

end MosModelLineVariables;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.moscalc"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.MosCalc</h1>
<p><strong>Further mosfet variables (for level 1, 2, 3 and 6)</strong></p>
<h2 id="information-3">Information</h2>
<p>::</p>
<p>This record MosCalc contains further mosfet variables (for level 1, 2, 3 and 6).</p>
<p>::</p>
<p>Extends from <a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.MosfetCalc">Mosfet.MosfetCalc</a> (Mosfet Variables).</p>
<h2 id="parameters-1">Parameters</h2>
<table>
<col width="26%" />
<col width="25%" />
<col width="16%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Initialization</td>
<td align="left">
</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">m_mode.start</td>
<td align="left">1</td>
<td align="left">Mode</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-2">Modelica definition</h2>
<pre><code>record MosCalc &quot;Further mosfet variables (for level 1, 2, 3 and 6)&quot;
  extends Mosfet.MosfetCalc;

  Modelica.SIunits.Transconductance m_tTransconductance( start = 0.);
  Real m_tSurfMob( start = 0.);
  Modelica.SIunits.Voltage m_tPhi( start = 0.7);
  Modelica.SIunits.Voltage m_tVto( start = 1.);
  Real m_tSatCurDens( start = 0.);
  Modelica.SIunits.Current m_tDrainSatCur( start = 0.);
  Modelica.SIunits.Current m_tSourceSatCur( start = 0.);
  Modelica.SIunits.Capacitance m_tCBDb( start = 0.);
  Modelica.SIunits.Capacitance m_tCBDs( start = 0.);
  Modelica.SIunits.Capacitance m_tCBSb( start = 0.);
  Modelica.SIunits.Capacitance m_tCBSs( start = 0.);
  Real m_tCj( start = 0.);
  Real m_tCjsw( start = 0.);
  Modelica.SIunits.Voltage m_tBulkPot( start = 0.7);
  Real m_tDepCap( start = 0.35);
  Modelica.SIunits.Voltage m_tVbi( start = 1.);
  Modelica.SIunits.Voltage m_VBScrit( start = 0.7);
  Modelica.SIunits.Voltage m_VBDcrit( start = 0.7);
  Real m_f1b( start = 0.);
  Real m_f2b( start = 0.);
  Real m_f3b( start = 0.);
  Real m_f1s( start = 0.);
  Real m_f2s( start = 0.);
  Real m_f3s( start = 0.);
  Real m_dVt( start = 0.);

  Modelica.SIunits.Capacitance m_capgd( start = 0.);
  Modelica.SIunits.Capacitance m_capgs( start = 0.);
  Modelica.SIunits.Capacitance m_capgb( start = 0.);
  Modelica.SIunits.Charge m_qgs( start = 0.);
  Modelica.SIunits.Charge m_qgd( start = 0.);
  Modelica.SIunits.Charge m_qgb( start = 0.);

end MosCalc;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.devqmeyer"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.DEVqmeyer</h1>
<p><strong>Meyer capacities and charge</strong></p>
<h2 id="information-4">Information</h2>
<p>::</p>
<p>This record DEVqmeyer contains values that are needed for the calculation of the meyer capacities and charge.</p>
<p>::</p>
<h2 id="modelica-definition-3">Modelica definition</h2>
<pre><code>record DEVqmeyer &quot;Meyer capacities and charge&quot;

  Modelica.SIunits.Capacitance qm_capgb(  start = 0);
  Modelica.SIunits.Capacitance qm_capgs(  start = 0);
  Modelica.SIunits.Capacitance qm_capgd(  start = 0);
  Modelica.SIunits.Charge qm_qgs(  start = 0);
  Modelica.SIunits.Charge qm_qgb(  start = 0);
  Modelica.SIunits.Charge qm_qgd(  start = 0);
  Modelica.SIunits.Voltage qm_vgs(  start = 0);
  Modelica.SIunits.Voltage qm_vgb(  start = 0);
  Modelica.SIunits.Voltage qm_vgd(  start = 0);

end DEVqmeyer;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.currrentscapacitances"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.CurrrentsCapacitances</h1>
<p><strong>Currents and Capacities</strong></p>
<h2 id="information-5">Information</h2>
<p>::</p>
<p>This record CurrentsCapacities contains values for the currents and the capacities inside the mosfet models level 1, 2, 3 and 6.</p>
<p>::</p>
<h2 id="modelica-definition-4">Modelica definition</h2>
<pre><code>record CurrrentsCapacitances &quot;Currents and Capacities&quot;

  Modelica.SIunits.Current idrain( start = 0);
  Modelica.SIunits.Current iBD( start = 0);
  Modelica.SIunits.Current iBS( start = 0);
  Modelica.SIunits.Capacitance cGS( start = 0);
  Modelica.SIunits.Capacitance cGB( start = 0);
  Modelica.SIunits.Capacitance cGD( start = 0);
  Modelica.SIunits.Capacitance cBS( start = 0);
  Modelica.SIunits.Capacitance cBD( start = 0);
  Modelica.SIunits.Capacitance m_capgd;

end CurrrentsCapacitances;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.moscalcinitequations"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mosCalcInitEquations</h1>
<p><strong>Mosfet initial precalculations (level 1)</strong></p>
<h2 id="information-6">Information</h2>
<p>::</p>
<p>This function mosCalcInitEquations does the initial precalculation of the mosfet parameters (level 1).</p>
<p>::</p>
<h2 id="inputs">Inputs</h2>
<table>
<col width="66%" />
<col width="5%" />
<col width="5%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1ModelLineParams">Mos1ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record model line parameters for MOS1</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Input record SPICE constants</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
</tbody>
</table>
<h2 id="outputs">Outputs</h2>
<table>
<col width="68%" />
<col width="6%" />
<col width="24%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1Calc">Mos1Calc</a></td>
<td align="left">out_c</td>
<td align="left">Output record Mos1 calculated values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-5">Modelica definition</h2>
<pre><code>function mosCalcInitEquations 
  &quot;Mosfet initial precalculations (level 1)&quot;

  input Mos1.Mos1ModelLineParams in_p 
    &quot;Input record model line parameters for MOS1&quot;;
  input SpiceConstants in_C &quot;Input record SPICE constants&quot;;
  input Mos.MosModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;

  output Mos1.Mos1Calc out_c &quot;Output record Mos1 calculated values&quot;;

algorithm 
   out_c.m_drainResistance := if 
                                (in_p.m_drainResistanceIsGiven &gt; 0.5) then 
       in_p.m_drainResistance else 
       in_p.m_sheetResistance * in_m.m_drainSquares;

   out_c.m_sourceResistance := if  (in_p.m_sourceResistanceIsGiven &gt; 0.5) then 
       in_p.m_sourceResistance else 
       in_p.m_sheetResistance * in_m.m_sourceSquares;

  out_c.m_lEff := in_m.m_len - 2 * in_p.m_latDiff;

  if ( abs( out_c.m_lEff) &lt; 1e-18) then
    out_c.m_lEff := 1e-6;
  end if;
  out_c.m_capGSovl := in_p.m_gateSourceOverlapCapFactor * in_m.m_width;
  out_c.m_capGDovl := in_p.m_gateDrainOverlapCapFactor * in_m.m_width;

  out_c.m_capGBovl := in_p.m_gateBulkOverlapCapFactor * out_c.m_lEff;
  out_c.m_capOx    := in_vp.m_oxideCapFactor * out_c.m_lEff * in_m.m_width;

end mosCalcInitEquations;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.moscalccalctempdependencies"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mosCalcCalcTempDependencies</h1>
<p><strong>Precalculation relating to temperature</strong></p>
<h2 id="information-7">Information</h2>
<p>::</p>
<p>This function mosCalcCalcTempDependencies does precalculation relating to the temperature (level 1).</p>
<p>::</p>
<h2 id="inputs-1">Inputs</h2>
<table>
<col width="64%" />
<col width="7%" />
<col width="5%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1ModelLineParams">Mos1ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record model line parameters for MOS1</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Input record SPICE constants</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1Calc">Mos1Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Mos1Calc</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">in_m_type</td>
<td align="left">
</td>
<td align="left">Type of MOS transistor</td>
</tr>
</tbody>
</table>
<h2 id="outputs-1">Outputs</h2>
<table>
<col width="68%" />
<col width="6%" />
<col width="24%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1Calc">Mos1Calc</a></td>
<td align="left">out_c</td>
<td align="left">Output record with calculated values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-6">Modelica definition</h2>
<pre><code>function mosCalcCalcTempDependencies 
  &quot;Precalculation relating to temperature&quot;

  input Mos1.Mos1ModelLineParams in_p 
    &quot;Input record model line parameters for MOS1&quot;;
  input SpiceConstants in_C &quot;Input record SPICE constants&quot;;
  input Mos.MosModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;
  input Mos1.Mos1Calc in_c &quot;Input record Mos1Calc&quot;;
  input Integer in_m_type &quot;Type of MOS transistor&quot;;

  output Mos1.Mos1Calc out_c &quot;Output record with calculated values&quot;;

protected 
   Real ratio;
   Real ratio4;
   Real res;

algorithm 
  out_c := in_c;

  ratio                     := in_m.m_dTemp / in_p.m_tnom;
  ratio4                    := ratio * sqrt(ratio);
  out_c.m_tTransconductance := in_vp.m_transconductance / ratio4;
  out_c.m_Beta              := out_c.m_tTransconductance * in_m.m_width / out_c.m_lEff;

  out_c.m_tSurfMob          := in_p.m_surfaceMobility / ratio4;

  out_c.m_tPhi := Modelica.Electrical.Spice3.Internal.Functions.junctionPotDepTemp(
                                              in_vp.m_phi, in_m.m_dTemp, in_p.m_tnom);

  out_c.m_tVbi := in_vp.m_vt0 - in_m_type * (in_vp.m_gamma * sqrt(in_vp.m_phi)) +0.5  *
                  (Modelica.Electrical.Spice3.Internal.Functions.energyGapDepTemp(
                                              in_p.m_tnom) - Modelica.Electrical.Spice3.Internal.Functions.energyGapDepTemp(
                                                                                        in_m.m_dTemp))
                  + in_m_type *0.5  * (out_c.m_tPhi - in_vp.m_phi);
  out_c.m_tVto := out_c.m_tVbi + in_m_type * in_vp.m_gamma * sqrt(out_c.m_tPhi);

  out_c.m_tBulkPot := Modelica.Electrical.Spice3.Internal.Functions.junctionPotDepTemp(
                                                  in_p.m_bulkJctPotential,in_m.m_dTemp, in_p.m_tnom);
  out_c.m_tDepCap  := in_p.m_fwdCapDepCoeff * out_c.m_tBulkPot;

 if (in_p.m_jctSatCurDensity == 0.0 or in_m.m_sourceArea == 0.0 or in_m.m_drainArea == 0.0) then
    out_c.m_tDrainSatCur  := Modelica.Electrical.Spice3.Internal.Functions.saturationCurDepTempSPICE3MOSFET(
                             in_p.m_jctSatCur, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tSourceSatCur := out_c.m_tDrainSatCur;
    out_c.m_VBScrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tSourceSatCur);
    out_c.m_VBDcrit       := out_c.m_VBScrit;
  else
    out_c.m_tSatCurDens   := Modelica.Electrical.Spice3.Internal.Functions.saturationCurDepTempSPICE3MOSFET(
                             in_p.m_jctSatCurDensity, in_m.m_dTemp,in_p.m_tnom);
    out_c.m_tDrainSatCur  := out_c.m_tSatCurDens * in_m.m_drainArea;
    out_c.m_tSourceSatCur := out_c.m_tSatCurDens * in_m.m_sourceArea;
    out_c.m_VBScrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tSourceSatCur);
    out_c.m_VBDcrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tDrainSatCur);
  end if;

  if ( not (in_p.m_capBDIsGiven &gt; 0.5) or not (in_p.m_capBSIsGiven &gt; 0.5)) then
    (res,out_c.m_tCj)   := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_bulkCapFactor,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    (res,out_c.m_tCjsw) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_sideWallCapFactor,
                              in_p.m_bulkJctSideGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    (out_c.m_f1s, out_c.m_f2s, out_c.m_f3s) := Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
                              in_p.m_bulkJctSideGradingCoeff, in_p.m_fwdCapDepCoeff, out_c.m_tBulkPot);
  end if;

  if (in_p.m_capBDIsGiven &gt; 0.5) then
    (res,out_c.m_tCBDb) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_capBD,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tCBDs          := 0.0;
  else
    out_c.m_tCBDb := out_c.m_tCj * in_m.m_drainArea;
    out_c.m_tCBDs := out_c.m_tCjsw * in_m.m_drainPerimiter;
  end if;

  if (in_p.m_capBSIsGiven &gt; 0.5) then
    (res,out_c.m_tCBSb) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_capBS,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tCBSs          := 0.0;
  else
    out_c.m_tCBSb := out_c.m_tCj * in_m.m_sourceArea;
    out_c.m_tCBSs := out_c.m_tCjsw * in_m.m_sourcePerimiter;
  end if;
   (out_c.m_f1b, out_c.m_f2b, out_c.m_f3b) := Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
                                              in_p.m_bulkJctBotGradingCoeff,
                                              in_p.m_fwdCapDepCoeff, out_c.m_tBulkPot);
  out_c.m_dVt   := in_m.m_dTemp * SpiceConstants.CONSTKoverQ;

end mosCalcCalcTempDependencies;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.moscalcnobypasscode"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mosCalcNoBypassCode</h1>
<p><strong>Calculation of currents and capacities (level 1)</strong></p>
<h2 id="information-8">Information</h2>
<p>::</p>
<p>This function NoBypassCode calculates the currents (and the capacitances) that are necessary for the currents sum in the toplevelmodel (level 1).</p>
<p>::</p>
<h2 id="inputs-2">Inputs</h2>
<table>
<col width="60%" />
<col width="12%" />
<col width="5%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">in_m_type</td>
<td align="left">
</td>
<td align="left">Type of MOS transistor</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1Calc">Mos1Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Mos1Calc</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos1.html#Modelica.Electrical.Spice3.Internal.Mos1.Mos1ModelLineParams">Mos1ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record model line parameters for MOS1</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Input record SPICE constants</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">in_m_bInit</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">in_m_pVoltageValues[4]</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-2">Outputs</h2>
<table>
<col width="83%" />
<col width="7%" />
<col width="9%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.CurrrentsCapacitances">CurrrentsCapacitances</a></td>
<td align="left">out_cc</td>
<td align="left">
</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-7">Modelica definition</h2>
<pre><code>function mosCalcNoBypassCode 
  &quot;Calculation of currents and capacities (level 1)&quot;

  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;
  input Integer in_m_type &quot;Type of MOS transistor&quot;;
  input Mos1.Mos1Calc in_c &quot;Input record Mos1Calc&quot;;
  input Mos1.Mos1ModelLineParams in_p 
    &quot;Input record model line parameters for MOS1&quot;;
  input SpiceConstants in_C &quot;Input record SPICE constants&quot;;
  input Mos.MosModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Boolean in_m_bInit;
  input Modelica.SIunits.Voltage[4] in_m_pVoltageValues; /* gate bulk drain source */

  output CurrrentsCapacitances out_cc;

protected 
  Modelica.SIunits.Voltage vbd;
  Modelica.SIunits.Voltage vgd;
  Modelica.SIunits.Voltage vgb;
  Modelica.SIunits.Current cur;
  Integer n;
  DEVqmeyer qm;
  Mos1.Mos1Calc int_c;
  Real hlp;

algorithm 
  int_c := in_c;

  int_c.m_vgs := in_m_type * (in_m_pVoltageValues[1] - in_m_pVoltageValues[4]); // ( G , SP)
  int_c.m_vbs := in_m_type * (in_m_pVoltageValues[2] - in_m_pVoltageValues[4]); // ( B , SP)
  int_c.m_vds := in_m_type * (in_m_pVoltageValues[3] - in_m_pVoltageValues[4]); // ( DP, SP)

  if ( SpiceRoot.useInitialConditions())    and (in_m.m_dICVBSIsGiven &gt;0.5) then
    int_c.m_vbs := in_m_type * in_m.m_dICVBS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    int_c.m_vbs := if (in_m.m_off &gt;0.5) then 0. else int_c.m_VBScrit;
  end if;
  if ( SpiceRoot.useInitialConditions()) and (in_m.m_dICVDSIsGiven &gt; 0.5) then
    int_c.m_vds := in_m_type * in_m.m_dICVDS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    int_c.m_vds := if (in_m.m_off &gt; 0.5) then 0. else (int_c.m_VBDcrit - int_c.m_VBScrit);
  end if;
  if ( SpiceRoot.useInitialConditions()) and (in_m.m_dICVGSIsGiven &gt; 0.5) then
    int_c.m_vgs := in_m_type * in_m.m_dICVGS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    if ( in_m.m_off &gt; 0.5) then
      int_c.m_vgs := 0.;
    end if;
  end if;

  vbd := int_c.m_vbs - int_c.m_vds;
  vgd := int_c.m_vgs - int_c.m_vds;

  if ( int_c.m_vds &gt;= 0) then
    vbd         := int_c.m_vbs - int_c.m_vds;
  else
      int_c.m_vbs := vbd + int_c.m_vds;
  end if;

  vgb := int_c.m_vgs - int_c.m_vbs;

   (int_c.m_cbd, int_c.m_gbd) := Modelica.Electrical.Spice3.Internal.Functions.junction2SPICE3MOSFET(
                                                                 int_c.m_cbd, int_c.m_gbd, vbd,
                                 in_m.m_dTemp, 1.0, int_c.m_tDrainSatCur);
   out_cc.iBD                 := in_m_type * int_c.m_cbd;
   (int_c.m_cbs, int_c.m_gbs) := Modelica.Electrical.Spice3.Internal.Functions.junction2SPICE3MOSFET(
                                                                 int_c.m_cbs, int_c.m_gbs, int_c.m_vbs,
                                 in_m.m_dTemp, 1.0, int_c.m_tSourceSatCur);
   out_cc.iBS                 := in_m_type * int_c.m_cbs;

  int_c.m_mode := if (int_c.m_vds &gt;= 0) then 1 else -1; // 1: normal mode, -1: inverse mode

  if (int_c.m_mode == 1) then

    int_c := Mos1.drainCur( int_c.m_vbs, int_c.m_vgs, int_c.m_vds, int_c, in_p, in_C, in_vp, in_m_type);
  else
    int_c := Mos1.drainCur( vbd,               vgd,  -int_c.m_vds, int_c, in_p, in_C, in_vp, in_m_type);
  end if;

  n      := if (int_c.m_mode == 1) then 6 else 5;
  out_cc.idrain := in_m_type * int_c.m_cdrain * int_c.m_mode;

  int_c.m_capbss    := 0.0;
  int_c.m_chargebss := 0.0;
  int_c.m_capbds    := 0.0;
  int_c.m_chargebds := 0.0;
  (int_c.m_capbsb, int_c.m_chargebsb) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBSb, int_c.m_vbs, int_c.m_tDepCap,
         in_p.m_bulkJctBotGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1b, int_c.m_f2b, int_c.m_f3b);

  (int_c.m_capbdb, int_c.m_chargebdb) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBDb, vbd, int_c.m_tDepCap,
         in_p.m_bulkJctBotGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1b, int_c.m_f2b, int_c.m_f3b);

  if ( not (in_p.m_capBSIsGiven &gt; 0.5)) then
    (int_c.m_capbss, int_c.m_chargebss) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBSs,int_c. m_vbs, int_c.m_tDepCap,
         in_p.m_bulkJctSideGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1s, int_c.m_f2s, int_c.m_f3s);
  end if;

  if (not (in_p.m_capBDIsGiven &gt; 0.5)) then
    (int_c.m_capbds, int_c.m_chargebds) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBDs, vbd, int_c.m_tDepCap,
         in_p.m_bulkJctSideGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1s, int_c.m_f2s, int_c.m_f3s);
  end if;

  out_cc.cBS := if (in_m_bInit) then 1e-15 else (int_c.m_capbsb + int_c.m_capbss);

  out_cc.cBD := if (in_m_bInit) then 1e-15 else (int_c.m_capbdb + int_c.m_capbds);
  if (int_c.m_mode &gt; 0) then
    qm := mosCalcDEVqmeyer( int_c.m_vgs, vgd, vgb, int_c);
  else
    qm := mosCalcDEVqmeyer( vgd, int_c.m_vgs, vgb, int_c);
    hlp := qm.qm_capgd;
    qm.qm_capgd := qm.qm_capgs;
    qm.qm_capgs := hlp;
  end if;

    int_c.m_capgd := 2 * qm.qm_capgd + int_c.m_capGDovl;
    int_c.m_capgs := 2 * qm.qm_capgs + int_c.m_capGSovl;
    int_c.m_capgb := 2 * qm.qm_capgb + int_c.m_capGBovl;

  out_cc.cGB := if (in_m_bInit) then -1e40 else int_c.m_capgb;
  out_cc.cGD := if (in_m_bInit) then -1e40 else int_c.m_capgd;
  out_cc.cGS := if (in_m_bInit) then -1e40 else int_c.m_capgs;

end mosCalcNoBypassCode;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.moscalcdevqmeyer"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mosCalcDEVqmeyer</h1>
<p><strong>Calculation of meyer capacities</strong></p>
<h2 id="information-9">Information</h2>
<p>::</p>
<p>This function mosCalcDEVqmeyer calculates the meyer capacities and charge for the meyer model.</p>
<p>::</p>
<h2 id="inputs-3">Inputs</h2>
<table>
<col width="70%" />
<col width="6%" />
<col width="7%" />
<col width="14%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">vgs</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">vgd</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">vgb</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosCalc">MosCalc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input variable set</td>
</tr>
</tbody>
</table>
<h2 id="outputs-3">Outputs</h2>
<table>
<col width="79%" />
<col width="8%" />
<col width="12%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.DEVqmeyer">DEVqmeyer</a></td>
<td align="left">out_qm</td>
<td align="left">Qmeyer values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-8">Modelica definition</h2>
<pre><code>function mosCalcDEVqmeyer &quot;Calculation of meyer capacities&quot;

  input Modelica.SIunits.Voltage vgs;
  input Modelica.SIunits.Voltage vgd;
  input Modelica.SIunits.Voltage vgb;
  input MosCalc in_c &quot;Input variable set&quot;;

  output DEVqmeyer out_qm &quot;Qmeyer values&quot;;

protected 
  Modelica.SIunits.Voltage vds;
  Real vddif;
  Real vddif1;
  Real vddif2;
  Modelica.SIunits.Voltage vgst;

algorithm 
  vgst := vgs - in_c.m_von;
  if (vgst &lt;= -in_c.m_tPhi) then
    out_qm.qm_capgb := in_c.m_capOx / 2.;
    out_qm.qm_capgs := 0.;
    out_qm.qm_capgd := 0.;
  elseif (vgst &lt;= -in_c.m_tPhi / 2.) then
    out_qm.qm_capgb := -vgst * in_c.m_capOx / (2. * in_c.m_tPhi);
    out_qm.qm_capgs := 0.;
    out_qm.qm_capgd := 0.;
  elseif (vgst &lt;= 0.) then
    out_qm.qm_capgb := -vgst * in_c.m_capOx / (2. * in_c.m_tPhi);
    out_qm.qm_capgs := vgst * in_c.m_capOx / (1.5 * in_c.m_tPhi) + in_c.m_capOx / 3.;
    out_qm.qm_capgd := 0.;
  else
    vds := vgs - vgd;
    if (in_c.m_vdsat &lt;= vds) then
      out_qm.qm_capgs := in_c.m_capOx / 3.;
      out_qm.qm_capgd := 0.;
      out_qm.qm_capgb := 0.;
    else
      vddif  := 2.0 * in_c.m_vdsat - vds;
      vddif1 := in_c.m_vdsat - vds;
      vddif2 := vddif * vddif;
      out_qm.qm_capgd := in_c.m_capOx * (1. - in_c.m_vdsat  * in_c.m_vdsat  / vddif2) / 3.;
      out_qm.qm_capgs := in_c.m_capOx * (1. - vddif1 * vddif1 / vddif2) / 3.;
      out_qm.qm_capgb := 0.;
    end if;
  end if;

end mosCalcDEVqmeyer;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.mos2calcinitequations"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mos2CalcInitEquations</h1>
<p><strong>Mosfet initial precalculations (level 1)</strong></p>
<h2 id="information-10">Information</h2>
<p>::</p>
<p>This function mosCalcInitEquations does the initial precalculation of the mosfet parameters (level 2).</p>
<p>::</p>
<h2 id="inputs-4">Inputs</h2>
<table>
<col width="69%" />
<col width="5%" />
<col width="6%" />
<col width="19%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2ModelLineParams">Mos2ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record Mos2 values</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Spice constants</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
</tbody>
</table>
<h2 id="outputs-4">Outputs</h2>
<table>
<col width="68%" />
<col width="6%" />
<col width="24%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2Calc">Mos2Calc</a></td>
<td align="left">out_c</td>
<td align="left">Output record Mos2 calculated values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-9">Modelica definition</h2>
<pre><code>function mos2CalcInitEquations 
  &quot;Mosfet initial precalculations (level 1)&quot;

  input Mos2.Mos2ModelLineParams in_p &quot;Input record Mos2 values&quot;;
  input SpiceConstants in_C &quot;Spice constants&quot;;
  input Mos.MosModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;

  output Mos2.Mos2Calc out_c &quot;Output record Mos2 calculated values&quot;;

algorithm 
 out_c.m_drainResistance := if  (in_p.m_drainResistanceIsGiven &gt; 0.5) then 
       in_p.m_drainResistance else 
       in_p.m_sheetResistance * in_m.m_drainSquares;

out_c.m_sourceResistance := if  (in_p.m_sourceResistanceIsGiven &gt; 0.5) then 
       in_p.m_sourceResistance else 
       in_p.m_sheetResistance * in_m.m_sourceSquares;

  out_c.m_lEff := in_m.m_len - 2 * in_p.m_latDiff;

  if ( abs( out_c.m_lEff) &lt; 1e-18) then
    out_c.m_lEff := 1e-6;
  end if;
  out_c.m_capGSovl := in_p.m_gateSourceOverlapCapFactor * in_m.m_width;
  out_c.m_capGDovl := in_p.m_gateDrainOverlapCapFactor * in_m.m_width;
  out_c.m_capGBovl := in_p.m_gateBulkOverlapCapFactor * out_c.m_lEff;

  out_c.m_capOx    := in_vp.m_oxideCapFactor * out_c.m_lEff * in_m.m_width;

end mos2CalcInitEquations;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.mos2calccalctempdependencies"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mos2CalcCalcTempDependencies</h1>
<p><strong>Precalculation relating to temperature</strong></p>
<h2 id="information-11">Information</h2>
<p>::</p>
<p>This function mosCalcCalcTempDependencies does precalculation relating to the temperature (level 2).</p>
<p>::</p>
<h2 id="inputs-5">Inputs</h2>
<table>
<col width="66%" />
<col width="7%" />
<col width="5%" />
<col width="19%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2ModelLineParams">Mos2ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Output record Mos1 calculated values</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Spice constants</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.MosModelLineVariables">MosModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2Calc">Mos2Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Mos2Calc</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">in_m_type</td>
<td align="left">
</td>
<td align="left">Type of MOS transistor</td>
</tr>
</tbody>
</table>
<h2 id="outputs-5">Outputs</h2>
<table>
<col width="68%" />
<col width="6%" />
<col width="24%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2Calc">Mos2Calc</a></td>
<td align="left">out_c</td>
<td align="left">Output record with calculated values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-10">Modelica definition</h2>
<pre><code>function mos2CalcCalcTempDependencies 
  &quot;Precalculation relating to temperature&quot;

  input Mos2.Mos2ModelLineParams in_p &quot;Output record Mos1 calculated values&quot;;
  input SpiceConstants in_C &quot;Spice constants&quot;;
  input Mos.MosModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;
  input Mos2.Mos2Calc in_c &quot;Input record Mos2Calc&quot;;
  input Integer in_m_type &quot;Type of MOS transistor&quot;;

  output Mos2.Mos2Calc out_c &quot;Output record with calculated values&quot;;

protected 
   Real ratio;
   Real ratio4;

algorithm 
  out_c := in_c;

  ratio                     := in_m.m_dTemp / in_p.m_tnom;
  ratio4                    := ratio * sqrt(ratio);
  out_c.m_tTransconductance := in_vp.m_transconductance / ratio4;
  out_c.m_Beta              := out_c.m_tTransconductance * in_m.m_width / out_c.m_lEff;

  out_c.m_tSurfMob          := in_p.m_surfaceMobility / ratio4;

  out_c.m_tPhi := Modelica.Electrical.Spice3.Internal.Functions.junctionPotDepTemp(
                                              in_vp.m_phi, in_m.m_dTemp, in_p.m_tnom);

  out_c.m_tVbi := in_vp.m_vt0 - in_m_type * (in_vp.m_gamma * sqrt(in_vp.m_phi)) +0.5  *
                  (Modelica.Electrical.Spice3.Internal.Functions.energyGapDepTemp(
                                              in_p.m_tnom) - Modelica.Electrical.Spice3.Internal.Functions.energyGapDepTemp(
                                                                                        in_m.m_dTemp))
                  + in_m_type *0.5  * (out_c.m_tPhi - in_vp.m_phi);
  out_c.m_tVto := out_c.m_tVbi + in_m_type * in_vp.m_gamma * sqrt(out_c.m_tPhi);

  out_c.m_tBulkPot := Modelica.Electrical.Spice3.Internal.Functions.junctionPotDepTemp(
                                                  in_p.m_bulkJctPotential,in_m.m_dTemp, in_p.m_tnom);
  out_c.m_tDepCap  := in_p.m_fwdCapDepCoeff * out_c.m_tBulkPot;

  if (in_p.m_jctSatCurDensity == 0.0 or in_m.m_sourceArea == 0.0 or in_m.m_drainArea == 0.0) then
    out_c.m_tDrainSatCur  := Modelica.Electrical.Spice3.Internal.Functions.saturationCurDepTempSPICE3MOSFET(
                             in_p.m_jctSatCur, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tSourceSatCur := out_c.m_tDrainSatCur;
    out_c.m_VBScrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tSourceSatCur);
    out_c.m_VBDcrit       := out_c.m_VBScrit;
  else
    out_c.m_tSatCurDens   := Modelica.Electrical.Spice3.Internal.Functions.saturationCurDepTempSPICE3MOSFET(
                             in_p.m_jctSatCurDensity, in_m.m_dTemp,in_p.m_tnom);
    out_c.m_tDrainSatCur  := out_c.m_tSatCurDens * in_m.m_drainArea;
    out_c.m_tSourceSatCur := out_c.m_tSatCurDens * in_m.m_sourceArea;
    out_c.m_VBScrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tSourceSatCur);
    out_c.m_VBDcrit       := Modelica.Electrical.Spice3.Internal.Functions.junctionVCrit(
                                                     in_m.m_dTemp, 1.0, out_c.m_tDrainSatCur);
  end if;

  if ( not (in_p.m_capBDIsGiven &gt; 0.5) or not (in_p.m_capBSIsGiven &gt; 0.5)) then
    (out_c.m_tCj)   := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_bulkCapFactor,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    (out_c.m_tCjsw) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_sideWallCapFactor,
                              in_p.m_bulkJctSideGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    (out_c.m_f1s, out_c.m_f2s, out_c.m_f3s) := Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
                              in_p.m_bulkJctSideGradingCoeff, in_p.m_fwdCapDepCoeff, out_c.m_tBulkPot);
  end if;

  if (in_p.m_capBDIsGiven &gt; 0.5) then
    (out_c.m_tCBDb) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_capBD,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tCBDs          := 0.0;
  else
    out_c.m_tCBDb := out_c.m_tCj * in_m.m_drainArea;
    out_c.m_tCBDs := out_c.m_tCjsw * in_m.m_drainPerimiter;
  end if;

  if (in_p.m_capBSIsGiven &gt; 0.5) then
    (out_c.m_tCBSb) := Modelica.Electrical.Spice3.Internal.Functions.junctionParamDepTempSPICE3(
                              in_p.m_bulkJctPotential, in_p.m_capBS,
                              in_p.m_bulkJctBotGradingCoeff, in_m.m_dTemp, in_p.m_tnom);
    out_c.m_tCBSs          := 0.0;
  else
    out_c.m_tCBSb := out_c.m_tCj * in_m.m_sourceArea;
    out_c.m_tCBSs := out_c.m_tCjsw * in_m.m_sourcePerimiter;
  end if;
   (out_c.m_f1b, out_c.m_f2b, out_c.m_f3b) := Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
                                              in_p.m_bulkJctBotGradingCoeff,
                                              in_p.m_fwdCapDepCoeff, out_c.m_tBulkPot);
  out_c.m_dVt   := in_m.m_dTemp * SpiceConstants.CONSTKoverQ;

end mos2CalcCalcTempDependencies;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.mos.mos2calcnobypasscode"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos">Modelica.Electrical.Spice3.Internal.Mos</a>.mos2CalcNoBypassCode</h1>
<p><strong>Calculation of currents and capacities (level 2)</strong></p>
<h2 id="information-12">Information</h2>
<p>::</p>
<p>This function NoBypassCode calculates the currents (and the capacitances) that are necessary for the currents sum in the toplevelmodel (level 2).</p>
<p>::</p>
<h2 id="inputs-6">Inputs</h2>
<table>
<col width="63%" />
<col width="13%" />
<col width="5%" />
<col width="17%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mosfet.html#Modelica.Electrical.Spice3.Internal.Mosfet.Mosfet">Mosfet</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record mosfet parameters</td>
</tr>
<tr class="even">
<td align="left">Integer</td>
<td align="left">in_m_type</td>
<td align="left">
</td>
<td align="left">Type of MOS transistor</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2Calc">Mos2Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Mos2Calc</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2ModelLineParams">Mos2ModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record model line parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">in_C</td>
<td align="left">
</td>
<td align="left">Spice constants</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos2.html#Modelica.Electrical.Spice3.Internal.Mos2.Mos2ModelLineVariables">Mos2ModelLineVariables</a></td>
<td align="left">in_vp</td>
<td align="left">
</td>
<td align="left">Input record model line variables</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">in_m_bInit</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">in_m_pVoltageValues[4]</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-6">Outputs</h2>
<table>
<col width="72%" />
<col width="6%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.CurrrentsCapacitances">CurrrentsCapacitances</a></td>
<td align="left">out_cc</td>
<td align="left">Calculated currents and capacitances</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Mos.html#Modelica.Electrical.Spice3.Internal.Mos.DEVqmeyer">DEVqmeyer</a></td>
<td align="left">qm</td>
<td align="left">Calculated qmeyer values</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-11">Modelica definition</h2>
<pre><code>function mos2CalcNoBypassCode 
  &quot;Calculation of currents and capacities (level 2)&quot;

  input Mosfet.Mosfet in_m &quot;Input record mosfet parameters&quot;;
  input Integer in_m_type &quot;Type of MOS transistor&quot;;
  input Mos2.Mos2Calc in_c &quot;Input record Mos2Calc&quot;;
  input Mos2.Mos2ModelLineParams in_p &quot;Input record model line parameters&quot;;
  input SpiceConstants in_C &quot;Spice constants&quot;;
  input Mos2.Mos2ModelLineVariables in_vp &quot;Input record model line variables&quot;;
  input Boolean in_m_bInit;
  input Modelica.SIunits.Voltage[4] in_m_pVoltageValues; /* gate bulk drain source */

  output CurrrentsCapacitances out_cc &quot;Calculated currents and capacitances&quot;;

  output DEVqmeyer qm &quot;Calculated qmeyer values&quot;;

protected 
  Modelica.SIunits.Voltage vbd &quot;Voltage&quot;;
  Modelica.SIunits.Voltage vgd &quot;Volatge&quot;;
  Modelica.SIunits.Voltage vgb &quot;Voltage&quot;;
  Modelica.SIunits.Current cur &quot;Voltage&quot;;
  Integer n;

  DEVqmeyer in_qm &quot;Qmeyer capacitances&quot;;
  Mos2.Mos2Calc int_c &quot;Record Mos2Calc&quot;;
  Mosfet.Mosfet int_m &quot;Record Mosfet&quot;;
  Real hlp;
algorithm 
  int_c := in_c;

  int_c.m_vgs := in_m_type * (in_m_pVoltageValues[1] - in_m_pVoltageValues[4]); // ( G , SP)
  int_c.m_vbs := in_m_type * (in_m_pVoltageValues[2] - in_m_pVoltageValues[4]); // ( B , SP)
  int_c.m_vds := in_m_type * (in_m_pVoltageValues[3] - in_m_pVoltageValues[4]); // ( DP, SP)

  if ( SpiceRoot.useInitialConditions())    and (in_m.m_dICVBSIsGiven &gt;0.5) then
    int_c.m_vbs := in_m_type * in_m.m_dICVBS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    int_c.m_vbs := if (in_m.m_off &gt;0.5) then 0. else int_c.m_VBScrit;
  end if;
  if ( SpiceRoot.useInitialConditions()) and (in_m.m_dICVDSIsGiven &gt; 0.5) then
    int_c.m_vds := in_m_type * in_m.m_dICVDS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    int_c.m_vds := if (in_m.m_off &gt; 0.5) then 0. else (int_c.m_VBDcrit - int_c.m_VBScrit);
  end if;
  if ( SpiceRoot.useInitialConditions()) and (in_m.m_dICVGSIsGiven &gt; 0.5) then
    int_c.m_vgs := in_m_type * in_m.m_dICVGS;
  elseif ( SpiceRoot.initJunctionVoltages()) then
    if ( in_m.m_off &gt; 0.5) then
      int_c.m_vgs := 0.;
    end if;
  end if;

  if (int_c.m_vds&lt;&gt;0 and  int_c.m_vgs&lt;&gt;0 and int_c.m_vbs&lt;&gt;0 and not (SpiceRoot.useInitialConditions()) and  (in_m.m_off&lt;&gt;0)) then
    int_c.m_vbs := -1;
    int_c.m_vgs := in_m_type * int_c.m_tVto;
    int_c.m_vds := 0;
  end if;

  vbd := int_c.m_vbs - int_c.m_vds;
  vgd := int_c.m_vgs - int_c.m_vds;

  if ( int_c.m_vds &gt;= 0) then
   int_c.m_vbs := SpiceRoot.limitJunctionVoltage(int_c.m_vbs);
    vbd         := int_c.m_vbs - int_c.m_vds;
  else
    vbd         := SpiceRoot.limitJunctionVoltage(vbd);
    int_c.m_vbs := vbd + int_c.m_vds;
  end if;

  vgb := int_c.m_vgs - int_c.m_vbs;

   (int_c.m_cbd, int_c.m_gbd) := Modelica.Electrical.Spice3.Internal.Functions.junction2SPICE3MOSFET(
                                                                 int_c.m_cbd, int_c.m_gbd, vbd,
                                 in_m.m_dTemp, 1.0, int_c.m_tDrainSatCur);
   out_cc.iBD                 := in_m_type * int_c.m_cbd;
   (int_c.m_cbs, int_c.m_gbs) := Modelica.Electrical.Spice3.Internal.Functions.junction2SPICE3MOSFET(
                                                                 int_c.m_cbs, int_c.m_gbs, int_c.m_vbs,
                                 in_m.m_dTemp, 1.0, int_c.m_tSourceSatCur);
   out_cc.iBS                 := in_m_type * int_c.m_cbs;

  int_c.m_mode := if (int_c.m_vds &gt;= 0) then 1 else -1; // 1: normal mode, -1: inverse mode

  if (int_c.m_mode == 1) then

    int_c := Mos2.drainCur( int_c.m_vbs, int_c.m_vgs, int_c.m_vds,int_m, int_c, in_p, in_C, in_vp, in_m_type);
  else
    int_c := Mos2.drainCur( vbd,               vgd,  -int_c.m_vds,int_m, int_c, in_p, in_C, in_vp, in_m_type);
  end if;

  n      := if (int_c.m_mode == 1) then 6 else 5;
  out_cc.idrain := in_m_type * int_c.m_cdrain * int_c.m_mode;

  int_c.m_capbss    := 0.0;
  int_c.m_chargebss := 0.0;
  int_c.m_capbds    := 0.0;
  int_c.m_chargebds := 0.0;
  (int_c.m_capbsb, int_c.m_chargebsb) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBSb, int_c.m_vbs, int_c.m_tDepCap,
         in_p.m_bulkJctBotGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1b, int_c.m_f2b, int_c.m_f3b);

  (int_c.m_capbdb, int_c.m_chargebdb) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBDb, vbd, int_c.m_tDepCap,
         in_p.m_bulkJctBotGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1b, int_c.m_f2b, int_c.m_f3b);

  if ( not (in_p.m_capBSIsGiven &gt; 0.5)) then
    (int_c.m_capbss, int_c.m_chargebss) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBSs,int_c. m_vbs, int_c.m_tDepCap,
         in_p.m_bulkJctSideGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1s, int_c.m_f2s, int_c.m_f3s);
  end if;

  if (not (in_p.m_capBDIsGiven &gt; 0.5)) then
    (int_c.m_capbds, int_c.m_chargebds) := Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
         int_c.m_tCBDs, vbd, int_c.m_tDepCap,
         in_p.m_bulkJctSideGradingCoeff, int_c.m_tBulkPot,
         int_c.m_f1s, int_c.m_f2s, int_c.m_f3s);
  end if;

  out_cc.cBS := if (in_m_bInit) then 1e-15 else (int_c.m_capbsb + int_c.m_capbss);

  out_cc.cBD := if (in_m_bInit) then 1e-15 else (int_c.m_capbdb + int_c.m_capbds);

  if (int_c.m_mode &gt; 0) then
    qm := mosCalcDEVqmeyer( int_c.m_vgs, vgd, vgb, int_c);
  else
    qm := mosCalcDEVqmeyer( vgd, int_c.m_vgs, vgb, int_c);
    hlp := qm.qm_capgd;
    qm.qm_capgd := qm.qm_capgs;
    qm.qm_capgs := hlp;
  end if;

  if (in_m_bInit) then
    int_c.m_capgd := 2 * qm.qm_capgd + int_c.m_capGDovl;
    int_c.m_capgs := 2 * qm.qm_capgs + int_c.m_capGSovl;
    int_c.m_capgb := 2 * qm.qm_capgb + int_c.m_capGBovl;

    int_c.m_qgs   := int_c.m_capgs * int_c.m_vgs;
    int_c.m_qgb   := int_c.m_capgb * vgb;
    int_c.m_qgd   := int_c.m_capgd * vgd;
  else
    int_c.m_capgd := qm.qm_capgd + in_qm.qm_capgd + int_c.m_capGDovl;
    int_c.m_capgs := qm.qm_capgs + in_qm.qm_capgs + int_c.m_capGSovl;
    int_c.m_capgb := qm.qm_capgb + in_qm.qm_capgb + int_c.m_capGBovl;

    int_c.m_qgs   := (int_c.m_vgs - in_qm.qm_vgs) * int_c.m_capgs + in_qm.qm_qgs;
    int_c.m_qgb   := (vgb - in_qm.qm_vgb) * int_c.m_capgb + in_qm.qm_qgb;
    int_c.m_qgd   := (vgd - in_qm.qm_vgd) * int_c.m_capgd + in_qm.qm_qgd;
  end if;

    out_cc.m_capgd := int_c.m_capgd;

  qm.qm_qgs := int_c.m_qgs;
  qm.qm_qgb := int_c.m_qgb;
  qm.qm_qgd := int_c.m_qgd;
  qm.qm_vgs := int_c.m_vgs;
  qm.qm_vgb := vgb;
  qm.qm_vgd := vgd;

  out_cc.cGB := if (in_m_bInit) then -1e40 else int_c.m_capgb;
  out_cc.cGD := if (in_m_bInit) then -1e40 else out_cc.m_capgd;
  out_cc.cGS := if (in_m_bInit) then -1e40 else int_c.m_capgs;

end mos2CalcNoBypassCode;</code></pre>
<hr />
<p><a href="http://www.3ds.com/">Automatically generated</a> Fri Nov 12 16:29:47 2010.</p>
</body>
</html>
