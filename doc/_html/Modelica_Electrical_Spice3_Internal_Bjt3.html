<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Modelica.Electrical.Spice3.Internal.Bjt3</title>
</head>
<body>
<div id="header">
<h1 class="title">Modelica.Electrical.Spice3.Internal.Bjt3</h1>
</div>
<h1 id="modelica.electrical.spice3.internal.bjt3"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal">Modelica.Electrical.Spice3.Internal</a>.Bjt3</h1>
<p><strong>Records and functions for bjt model</strong></p>
<h2 id="information">Information</h2>
<p>::</p>
<p>This package Bjt3 contains functions and records with data of the Bjt3 bipolar transistor models.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Icons_Package.html#Modelica.Icons.Package">Modelica.Icons.Package</a> (Icon for standard packages).</p>
<h2 id="package-content">Package Content</h2>
<table>
<col width="84%" />
<col width="15%" />
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParamsS.png" alt="image18" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">Record for bjt model line parameters</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParamsS.png" alt="image19" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">Record for bjt model line variables</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtModelLineInitEquationsS.png" alt="image20" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtModelLineInitEquations">bjtModelLineInitEquations</a></td>
<td align="left">Initial calculation</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3S.png" alt="image21" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a></td>
<td align="left">Record for bjt3 device parameters</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3S.png" alt="image22" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Variables">Bjt3Variables</a></td>
<td align="left">Variables for the bjt3 model</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3S.png" alt="image23" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Calc">Bjt3Calc</a></td>
<td align="left">Bjt3 variables</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3S.png" alt="image24" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.CurrentsCapacitances">CurrentsCapacitances</a></td>
<td align="left">Bjt3 variables</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjt3InitEquationsS.png" alt="image25" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjt3InitEquations">bjt3InitEquations</a></td>
<td align="left">Initial calculation</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjt3InitEquationsS.png" alt="image26" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjt3CalcTempDependencies">bjt3CalcTempDependencies</a></td>
<td align="left">Temperature dependency calculation</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjt3InitEquationsS.png" alt="image27" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjt3NoBypassCode">bjt3NoBypassCode</a></td>
<td align="left">Calculation of currents</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.BjtS.png" alt="image28" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt">Bjt</a></td>
<td align="left">Record for bjt device parameters</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.BjtS.png" alt="image29" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtVariables">BjtVariables</a></td>
<td align="left">Variables for the bjt model</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image30" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquations">bjtInitEquations</a></td>
<td align="left">Initial calculation</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image31" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtNoBypassCode">bjtNoBypassCode</a></td>
<td align="left">Calculation of currents</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image32" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtRenameParameters">bjtRenameParameters</a></td>
<td align="left">Technology parameter renaming</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image33" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtRenameParametersDev">bjtRenameParametersDev</a></td>
<td align="left">Temperature calculation</td>
</tr>
<tr class="odd">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image34" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtRenameParametersDevTemp">bjtRenameParametersDevTemp</a></td>
<td align="left">Temperature calculation</td>
</tr>
<tr class="even">
<td align="left"><img src="Modelica.Electrical.Spice3.Internal.Bjt3.bjtInitEquationsS.png" alt="image35" /> <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.bjtRenameParametersType">bjtRenameParametersType</a></td>
<td align="left">Type</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtmodellineparams"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.BjtModelLineParams</h1>
<p><strong>Record for bjt model line parameters</strong></p>
<h2 id="information-1">Information</h2>
<p>::</p>
<p>This record contains the model line (also called model card) parameters that are used for the bipolar transistor model in SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition">Modelica definition</h2>
<pre><code>record BjtModelLineParams &quot;Record for bjt model line parameters&quot;

  Real m_type( start = 1) &quot;device type : 1 = n,  -1 = p&quot;;

  Boolean m_bNPN( start = true) &quot;NPN type device&quot;;
  Boolean m_bPNP( start = false) &quot;PNP type device&quot;;
  Modelica.SIunits.Temp_C m_tnom( start=SpiceConstants.CKTnomTemp) 
    &quot;TNOM, Parameter measurement temperature&quot;;
  Modelica.SIunits.Current m_satCur( start = 1.0e-16) &quot;IS, Saturation Current&quot;;
  Real m_betaF( start = 100.0) &quot;BF, Ideal forward beta&quot;;
  Real m_emissionCoeffF(  start = 1.0) &quot;NF, Forward emission coefficient&quot;;
  Real m_leakBEemissionCoeff( start = 1.5) 
    &quot;NE, B-E leakage emission coefficient&quot;;
  Modelica.SIunits.Current m_leakBEcurrent( start = 0.) 
    &quot;ISE, B-E leakage saturation current&quot;;
  Real m_c2( start = 0.) &quot;C2, Obsolete parameter name&quot;;
  Modelica.SIunits.Current m_leakBCcurrent( start = 0.) 
    &quot;ISC, B-C leakage saturation current&quot;;
  Real m_c4( start = 0.) &quot;C4, Obsolete parameter name&quot;;
  Real m_leakBEcurrentIsGiven;
  Real m_c2IsGiven;
  Real m_leakBCcurrentIsGiven;
  Real m_c4IsGiven;
  Real m_betaR( start = 1.0) &quot;BR, Ideal reverse beta&quot;;
  Real m_emissionCoeffR( start = 1.0) &quot;NR, Reverse emission coefficient&quot;;
  Real m_leakBCemissionCoeff( start = 2.0) 
    &quot;NC, B-C leakage emission coefficient&quot;;
  Modelica.SIunits.Voltage m_earlyVoltF( start = 0.0) 
    &quot;VAF, Forward Early voltage&quot;;
  Modelica.SIunits.Current m_rollOffF( start = 0.0) 
    &quot;IKF, Forward beta roll-off corner current&quot;;
  Modelica.SIunits.Voltage m_earlyVoltR( start = 0.0) 
    &quot;VAR, Reverse Early voltage&quot;;
  Modelica.SIunits.Current m_rollOffR( start = 0.0) 
    &quot;IKR, reverse beta roll-off corner current&quot;;
  Modelica.SIunits.Resistance m_emitterResist( start = 0.0) 
    &quot;RE, Emitter resistance&quot;;
  Modelica.SIunits.Resistance m_collectorResist( start = 0.0) 
    &quot;RC, Collector resistance&quot;;
  Modelica.SIunits.Current m_baseCurrentHalfResist( start = 0.0) 
    &quot;IRB, Current for base resistance=(rb+rbm)/2&quot;;
  Modelica.SIunits.Resistance m_baseResist( start = 0.0) 
    &quot;RB, Zero bias base resistance&quot;;
  Modelica.SIunits.Resistance m_minBaseResist( start = 0.0) 
    &quot;RBM, Minimum base resistance&quot;;
  Real m_minBaseResistIsGiven;
  Modelica.SIunits.Capacitance m_depletionCapBE( start = 0.0) 
    &quot;CJE, Zero bias B-E depletion capacitance&quot;;
  Modelica.SIunits.Voltage m_potentialBE( start = 0.75) 
    &quot;VJE, B-E built in potential&quot;;
  Real m_junctionExpBE( start = 0.33) &quot;MJE, B-E built in potential&quot;;
  Modelica.SIunits.Time m_transitTimeF( start = 0.0) 
    &quot;TF, Ideal forward transit time&quot;;
  Real m_transitTimeBiasCoeffF( start = 0.0) 
    &quot;XTF, Coefficient for bias dependence of TF&quot;;
  Modelica.SIunits.Current m_transitTimeHighCurrentF( start = 0.0) 
    &quot;ITF, High current dependence of TF&quot;;
  Modelica.SIunits.Voltage m_transitTimeFVBC( start = 0.0) 
    &quot;VTF, Voltage giving VBC dependence of TF&quot;;
  Modelica.SIunits.Temp_C m_excessPhase( start = 0.0) &quot;PTF, Excess phase&quot;;
  Modelica.SIunits.Capacitance m_depletionCapBC( start = 0.0) 
    &quot;CJC, Zero bias B-C depletion capacitance&quot;;
  Modelica.SIunits.Voltage m_potentialBC( start = 0.75) 
    &quot;VJC, B-C built in potential&quot;;
  Real m_junctionExpBC( start = 0.33) &quot;MJC, B-C junction grading coefficient&quot;;
  Real m_baseFractionBCcap( start = 1.0) 
    &quot;XCJC, Fraction of B-C cap to internal base&quot;;
  Modelica.SIunits.Time m_transitTimeR( start = 0.0) 
    &quot;TR, Ideal reverse transit time&quot;;
  Modelica.SIunits.Capacitance m_capCS( start = 0.0) 
    &quot;CJS, Zero bias C-S capacitance&quot;;
  Modelica.SIunits.Voltage m_potentialSubstrate( start = 0.75) 
    &quot;VJS, Zero bias C-S capacitance&quot;;
  Real m_exponentialSubstrate( start = 0.0) 
    &quot;MJS, Substrate junction grading coefficient&quot;;
  Real m_betaExp( start = 0.0) &quot;XTB, Forward and reverse beta temp. exp.&quot;;
  Modelica.SIunits.GapEnergy m_energyGap( start = 1.11) 
    &quot;EG, Energy gap for IS temp. dependency&quot;;
  Real m_tempExpIS( start = 3.0) &quot;XTI,Temp. exponent for IS&quot;;
  Real m_fNcoef( start = 0.0) &quot;KF, Flicker Noise Coefficient&quot;;
  Real m_fNexp( start = 1.0) &quot;AF, Flicker Noise Exponent&quot;;
  Real m_depletionCapCoeff( start = 0.5) 
    &quot;FC, Forward bias junction fit parameter&quot;;

  Real m_collectorConduct( start = 0.0);
  Real m_emitterConduct( start = 0.0);
  Real m_transitTimeVBCFactor( start = 0.0);
  Real m_excessPhaseFactor( start = 0.0);
  Real m_invEarlyVoltF( start = 0.0);
  Real m_invRollOffF( start = 0.0);
  Real m_invEarlyVoltR( start = 0.0);
  Real m_invRollOffR( start = 0.0);

end BjtModelLineParams;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtmodellinevariables"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.BjtModelLineVariables</h1>
<p><strong>Record for bjt model line variables</strong></p>
<h2 id="information-2">Information</h2>
<p>::</p>
<p>This record contains the model line (also called model card) variables that are used for the bipolar transistor model in SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition-1">Modelica definition</h2>
<pre><code>record BjtModelLineVariables &quot;Record for bjt model line variables&quot;

  Modelica.SIunits.Current m_leakBEcurrent;
  Modelica.SIunits.Current m_leakBCcurrent;
  Modelica.SIunits.Resistance m_minBaseResist;
  Real m_invEarlyVoltF;
  Real m_invRollOffF;
  Real m_invEarlyVoltR;
  Real m_invRollOffR;
  Modelica.SIunits.Conductance m_collectorConduct;
  Modelica.SIunits.Conductance m_emitterConduct;
  Real m_transitTimeVBCFactor;
  Real m_excessPhaseFactor;

  Integer m_type;

end BjtModelLineVariables;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtmodellineinitequations"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtModelLineInitEquations</h1>
<p><strong>Initial calculation</strong></p>
<h2 id="information-3">Information</h2>
<p>::</p>
<p>Within this function some parameters are initially precalculated from model line parameters.</p>
<p>::</p>
<h2 id="inputs">Inputs</h2>
<table>
<col width="65%" />
<col width="4%" />
<col width="5%" />
<col width="23%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
</tbody>
</table>
<h2 id="outputs">Outputs</h2>
<table>
<col width="70%" />
<col width="5%" />
<col width="24%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">out_v</td>
<td align="left">Output record with Bjt model line variables</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-2">Modelica definition</h2>
<pre><code>function bjtModelLineInitEquations &quot;Initial calculation&quot;

  input BjtModelLineParams in_p &quot;Input record with Bjt model line parameters&quot;;

  output BjtModelLineVariables out_v 
    &quot;Output record with Bjt model line variables&quot;;

protected 
  Real xfc;

algorithm 
  out_v.m_type := if 
                    (in_p.m_bPNP) then -1 else 1;

  if ( not (in_p.m_leakBEcurrentIsGiven &gt; 0.5) and (in_p.m_c2IsGiven &gt; 0.5)) then
    out_v.m_leakBEcurrent := in_p.m_c2 * in_p.m_satCur;
  end if;
  if ( not (in_p.m_leakBCcurrentIsGiven &gt; 0.5) and (in_p.m_c4IsGiven &gt; 0.5)) then
    out_v.m_leakBCcurrent := in_p.m_c4 * in_p.m_satCur;
  end if;
  if ( not (in_p.m_minBaseResistIsGiven &gt; 0.5)) then
    out_v.m_minBaseResist := in_p.m_baseResist;
  end if;
  if (in_p.m_earlyVoltF &lt;&gt; 0) then
    out_v.m_invEarlyVoltF := 1 / in_p.m_earlyVoltF;
  end if;
  if (in_p.m_rollOffF &lt;&gt; 0) then
    out_v.m_invRollOffF := 1 / in_p.m_rollOffF;
  end if;
  if (in_p.m_earlyVoltR &lt;&gt; 0) then
    out_v.m_invEarlyVoltR := 1 / in_p.m_earlyVoltR;
  end if;
  if (in_p.m_rollOffR &lt;&gt; 0) then
    out_v.m_invRollOffR := 1 / in_p.m_rollOffR;
  end if;
  if (in_p.m_collectorResist &lt;&gt; 0) then
    out_v.m_collectorConduct := 1 / in_p.m_collectorResist;
  end if;
  if (in_p.m_emitterResist &lt;&gt; 0) then
    out_v.m_emitterConduct := 1 / in_p.m_emitterResist;
  end if;
  if (in_p.m_transitTimeFVBC &lt;&gt; 0) then
    out_v.m_transitTimeVBCFactor := 1 / (in_p.m_transitTimeFVBC * 1.44);
  end if;
  out_v.m_excessPhaseFactor := (in_p.m_excessPhase / (180.0 / Modelica.Constants.pi)) * in_p.m_transitTimeF;

  xfc  := Modelica.Math.log(1 - in_p.m_depletionCapCoeff);

end bjtModelLineInitEquations;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.Bjt3</h1>
<p><strong>Record for bjt3 device parameters</strong></p>
<h2 id="information-4">Information</h2>
<p>::</p>
<p>This record contains the device parameters that are used for the bipolar transistor bjt3 model in SPICE3.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Electrical_Spice3_Internal_Model.html#Modelica.Electrical.Spice3.Internal.Model.Model">Model.Model</a> (Device Temperature).</p>
<h2 id="modelica-definition-3">Modelica definition</h2>
<pre><code>record Bjt3 &quot;Record for bjt3 device parameters&quot;
  extends Model.Model;

 Real m_area(  start = 1.0) &quot;AREA&quot;;
 Boolean m_bOff(  start = false) &quot;OFF&quot;;
 Modelica.SIunits.Voltage m_dICvbe( start = 0.0) &quot;IC_VBE&quot;;
 Real m_bICvbeIsGiven( start = 0.0);
 Modelica.SIunits.Voltage m_dICvce( start = 0.0) &quot;IC_VCE&quot;;
 Real m_bICvceIsGiven( start = 0.0);
 Boolean m_bSensArea( start = false) &quot;SENS_AREA&quot;;

  Real m_transitTimeHighCurrentF(start = 0.0);
  Real m_invRollOffF( start = 0);
  Real m_invRollOffR( start = 0);

end Bjt3;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3variables"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.Bjt3Variables</h1>
<p><strong>Variables for the bjt3 model</strong></p>
<h2 id="information-5">Information</h2>
<p>::</p>
<p>This record contains the model variables that are used for the bipoar transistor bjt3 model in SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition-4">Modelica definition</h2>
<pre><code>record Bjt3Variables &quot;Variables for the bjt3 model&quot;

  Modelica.SIunits.Current m_transitTimeHighCurrentF( start = 0.0);
  Real m_invRollOffF( start = 0.0);
  Real m_invRollOffR( start = 0.0);

end Bjt3Variables;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3calc"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.Bjt3Calc</h1>
<p><strong>Bjt3 variables</strong></p>
<h2 id="information-6">Information</h2>
<p>::</p>
<p>This record contains the model variables that are used for the bipolar transistor model in SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition-5">Modelica definition</h2>
<pre><code>record Bjt3Calc &quot;Bjt3 variables&quot;

  Modelica.SIunits.Current m_tSatCur = 0;
  Real m_tBetaF = 1;
  Real m_tBetaR = 1;
  Modelica.SIunits.Current m_tBEleakCur = 1e-14;
  Modelica.SIunits.Current m_tBCleakCur = 1e-14;
  Real m_tBEcap = 0;
  Real m_tBEpot = 0.7;
  Real m_tBCcap = 0;
  Real m_tBCpot = 0.7;
  Real m_tDepCapBE = 0.7;
  Real m_tDepCapBC = 0.7;
  Real m_tVcrit = 0.7;
  Real m_dVt = 0.25;
  Real m_tF1c = 0;
  Real m_f2c = 0;
  Real m_f3c = 0;
  Real m_tF1e = 0;
  Real m_f2e = 0;
  Real m_f3e = 0;

end Bjt3Calc;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.currentscapacitances"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.CurrentsCapacitances</h1>
<p><strong>Bjt3 variables</strong></p>
<h2 id="information-7">Information</h2>
<p>::</p>
<p>This record contains the model variables that are used for the bipoar transistor model in SPICE3.</p>
<p>::</p>
<h2 id="modelica-definition-6">Modelica definition</h2>
<pre><code>record CurrentsCapacitances &quot;Bjt3 variables&quot;

  Modelica.SIunits.Current iBE( start = 0.0);  //current through diode dE1 (ideal part)
  Modelica.SIunits.Current iBEN( start = 0.0); //current through diode dE2 (non ideal part)
  Modelica.SIunits.Current iBC( start = 0.0); //current through diode dC1 (ideal part)
  Modelica.SIunits.Current iBCN( start = 0.0); //current through diode dC2 (non ideal part)
  Modelica.SIunits.Current iCC( start = 0.0);  //channel current
  Modelica.SIunits.Current capbc( start = 0.0);
  Modelica.SIunits.Capacitance capbe( start = 0.0);
  Modelica.SIunits.Capacitance capbx( start = 0.0);
  Real iXX( start = 0.0);
  Modelica.SIunits.Capacitance capcs( start = 0.0);

end CurrentsCapacitances;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3initequations"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjt3InitEquations</h1>
<p><strong>Initial calculation</strong></p>
<h2 id="information-8">Information</h2>
<p>::</p>
<p>Within this function some parameters are initially precalculated from model line parameters.</p>
<p>::</p>
<h2 id="inputs-1">Inputs</h2>
<table>
<col width="66%" />
<col width="5%" />
<col width="5%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record Bjt3</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_pml</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">in_vl</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line variables</td>
</tr>
</tbody>
</table>
<h2 id="outputs-1">Outputs</h2>
<table>
<col width="72%" />
<col width="6%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Variables">Bjt3Variables</a></td>
<td align="left">out_v</td>
<td align="left">Output record with Bjt variables</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-7">Modelica definition</h2>
<pre><code>function bjt3InitEquations &quot;Initial calculation&quot;

  input Bjt3 in_p &quot;Input record Bjt3&quot;;
  input BjtModelLineParams in_pml &quot;Input record with Bjt model line parameters&quot;;
  input BjtModelLineVariables in_vl 
    &quot;Input record with Bjt model line variables&quot;;
  output Bjt3Variables out_v &quot;Output record with Bjt variables&quot;;

algorithm 
  // calculate the parameters that depend on the area factor
  out_v.m_transitTimeHighCurrentF := in_pml.m_transitTimeHighCurrentF * in_p.m_area;
  out_v.m_invRollOffF             := in_vl.m_invRollOffF / in_p.m_area;
  out_v.m_invRollOffR             := in_vl.m_invRollOffR / in_p.m_area;

end bjt3InitEquations;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3calctempdependencies"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjt3CalcTempDependencies</h1>
<p><strong>Temperature dependency calculation</strong></p>
<h2 id="information-9">Information</h2>
<p>::</p>
<p>In this function for the bipolar transistor model temperature dependencies are calculated using temperature treating functions from the equation package.</p>
<p>::</p>
<h2 id="inputs-2">Inputs</h2>
<table>
<col width="66%" />
<col width="5%" />
<col width="5%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a></td>
<td align="left">in_p3</td>
<td align="left">
</td>
<td align="left">Input record Bjt3</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Model.html#Modelica.Electrical.Spice3.Internal.Model.Model">Model</a></td>
<td align="left">m</td>
<td align="left">
</td>
<td align="left">Input record model</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">in_vl</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line variables</td>
</tr>
</tbody>
</table>
<h2 id="outputs-2">Outputs</h2>
<table>
<col width="75%" />
<col width="7%" />
<col width="17%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Calc">Bjt3Calc</a></td>
<td align="left">out_c</td>
<td align="left">Output record Bjt3Calc</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-8">Modelica definition</h2>
<pre><code>function bjt3CalcTempDependencies 
  &quot;Temperature dependency calculation&quot;

  input Bjt3 in_p3 &quot;Input record Bjt3&quot;;
  input BjtModelLineParams in_p &quot;Input record with Bjt model line parameters&quot;;
  input Model.Model m &quot;Input record model&quot;;
  input BjtModelLineVariables in_vl 
    &quot;Input record with Bjt model line variables&quot;;

  output Bjt3Calc out_c &quot;Output record Bjt3Calc&quot;;

protected 
  Real xfc;
  Real gmanew;
  Real fact1;
  Modelica.SIunits.Voltage vt;
  Real fact2;
  Real egfet;
  Real arg;
  Real pbfact;
  Real ratlog;
  Real ratio1;
  Real factlog;
  Real factor;
  Real bfactor;
  Real pbo;
  Real gmaold;
algorithm 

  fact1 := in_p.m_tnom/SpiceConstants.REFTEMP;
  vt := m.m_dTemp*SpiceConstants.CONSTKoverQ;
  fact2 := m.m_dTemp/SpiceConstants.REFTEMP;

  egfet  := 1.16 - (7.02e-4 * m.m_dTemp * m.m_dTemp) / (m.m_dTemp + 1108);

  arg := -egfet/(2*Modelica.Constants.k*m.m_dTemp) + 1.1150877/(
    Modelica.Constants.k*(SpiceConstants.REFTEMP + SpiceConstants.REFTEMP));
  pbfact := -2*vt*(1.5*Modelica.Math.log(fact2) + SpiceConstants.CHARGE*
    arg);

  ratlog  := Modelica.Math.log( m.m_dTemp / in_p.m_tnom);
  ratio1  := m.m_dTemp / in_p.m_tnom - 1;
  factlog := ratio1 * in_p.m_energyGap / vt + in_p.m_tempExpIS * ratlog;
  factor  := exp( factlog);
  bfactor := exp(ratlog * in_p.m_betaExp);
  pbo    := (in_p.m_potentialBE - pbfact) / fact1;
  gmaold := (in_p.m_potentialBE - pbo) / pbo;

  out_c.m_tSatCur    := in_p.m_satCur * factor * in_p3.m_area;
  out_c.m_tBetaF     := in_p.m_betaF * bfactor;
  out_c.m_tBetaR     := in_p.m_betaR * bfactor;
  out_c.m_tBEleakCur := in_vl.m_leakBEcurrent * exp(factlog / in_p.m_leakBEemissionCoeff) / bfactor
                        * in_p3.m_area;
  out_c.m_tBCleakCur := in_vl.m_leakBCcurrent * exp(factlog / in_p.m_leakBCemissionCoeff) / bfactor
                        * in_p3.m_area;

  out_c.m_tBEcap := in_p.m_depletionCapBE/(1 + in_p.m_junctionExpBE*(4e-4
    *(in_p.m_tnom - SpiceConstants.REFTEMP) - gmaold));
  out_c.m_tBEpot := fact2 * pbo + pbfact;

  gmanew := (out_c.m_tBEpot - pbo) / pbo;

  out_c.m_tBEcap := out_c.m_tBEcap*(1 + in_p.m_junctionExpBE*(4e-4*(m.m_dTemp
     - SpiceConstants.REFTEMP) - gmanew));

  pbo    := (in_p.m_potentialBC - pbfact) / fact1;
  gmaold := (in_p.m_potentialBC - pbo) / pbo;

  out_c.m_tBCcap := in_p.m_depletionCapBC/(1 + in_p.m_junctionExpBC*(4e-4
    *(in_p.m_tnom - SpiceConstants.REFTEMP) - gmaold));
  out_c.m_tBCpot := fact2 * pbo + pbfact;

  gmanew := (out_c.m_tBCpot - pbo) / pbo;

  out_c.m_tBCcap := out_c.m_tBCcap*(1 + in_p.m_junctionExpBC*(4e-4*(m.m_dTemp
     - SpiceConstants.REFTEMP) - gmanew));

  out_c.m_tDepCapBE := in_p.m_depletionCapCoeff * out_c.m_tBEpot;
  out_c.m_tDepCapBC := in_p.m_depletionCapCoeff * out_c.m_tBCpot;
  xfc               := Modelica.Math.log( 1 - in_p.m_depletionCapCoeff);
  out_c.m_tVcrit := vt*Modelica.Math.log(vt/(SpiceConstants.CONSTroot2*in_p.m_satCur));
  out_c.m_dVt       := vt;

  // calculate the parameters that depend on the area factor
  out_c.m_tBEcap := out_c.m_tBEcap * in_p3.m_area;
  out_c.m_tBCcap := out_c.m_tBCcap * in_p3.m_area;
  (out_c.m_tF1c,out_c.m_f2c,out_c.m_f3c) :=
    Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
          in_p.m_junctionExpBC,
          in_p.m_depletionCapCoeff,
          out_c.m_tBCpot);
  (out_c.m_tF1e,out_c.m_f2e,out_c.m_f3e) :=
    Modelica.Electrical.Spice3.Internal.Functions.junctionCapCoeffs(
          in_p.m_junctionExpBE,
          in_p.m_depletionCapCoeff,
          out_c.m_tBEpot);

end bjt3CalcTempDependencies;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt3nobypasscode"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjt3NoBypassCode</h1>
<p><strong>Calculation of currents</strong></p>
<h2 id="information-10">Information</h2>
<p>::</p>
<p>This function NoBypassCode calculates the currents (and the capacitances) that are necessary for the currents to be used in the toplevel model.</p>
<p>::</p>
<h2 id="inputs-3">Inputs</h2>
<table>
<col width="61%" />
<col width="12%" />
<col width="5%" />
<col width="20%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Model.html#Modelica.Electrical.Spice3.Internal.Model.Model">Model</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record model</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt">Bjt</a></td>
<td align="left">in_p3</td>
<td align="left">
</td>
<td align="left">Input record Bjt3</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Calc">Bjt3Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Bjt3Calc</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">in_vl</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">in_m_pVoltageValues[6]</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">in_m_bInit</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
</tbody>
</table>
<h2 id="outputs-3">Outputs</h2>
<table>
<col width="65%" />
<col width="5%" />
<col width="28%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.CurrentsCapacitances">CurrentsCapacitances</a></td>
<td align="left">out_cc</td>
<td align="left">Output record with calculated currents and capacitances</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbe</td>
<td align="left">Capacitance [F]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbc</td>
<td align="left">Capacitance [F]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbx</td>
<td align="left">Capacitance [F]</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-9">Modelica definition</h2>
<pre><code>function bjt3NoBypassCode &quot;Calculation of currents&quot;

  input Model.Model in_m &quot;Input record model&quot;;
  input Bjt in_p3 &quot;Input record Bjt3&quot;;
  input BjtModelLineParams in_p &quot;Input record with Bjt model line parameters&quot;;
  input Bjt3Calc in_c &quot;Input record Bjt3Calc&quot;;
  input BjtModelLineVariables in_vl 
    &quot;Input record with Bjt model line variables&quot;;
  input Modelica.SIunits.Voltage[6] in_m_pVoltageValues; /* 1 Col; 2 Base; 3 Emit; 4 ColP; 5 BaseP; 6 EmitP */
  input Boolean in_m_bInit;

  output CurrentsCapacitances out_cc 
    &quot;Output record with calculated currents and capacitances&quot;;

  output Modelica.SIunits.Capacitance capbe &quot;Capacitance&quot;;
  output Modelica.SIunits.Capacitance capbc &quot;Capacitance&quot;;
  output Modelica.SIunits.Capacitance capbx &quot;Capacitance&quot;;

protected 
  Modelica.SIunits.Voltage vce;
  Modelica.SIunits.Voltage vbe;
  Modelica.SIunits.Voltage vbx;
  Modelica.SIunits.Voltage vbc;
  Modelica.SIunits.Conductance gbe;
  Modelica.SIunits.Current cbe;
  Modelica.SIunits.Conductance gbc;
  Modelica.SIunits.Current cbc;
  Modelica.SIunits.Conductance gben;
  Modelica.SIunits.Current cben;
  Modelica.SIunits.Conductance gbcn;
  Modelica.SIunits.Current cbcn;
  Modelica.SIunits.Current cjbe;
  Modelica.SIunits.Current cjbc;
    Real dqbdve;
    Real dqbdvc;
    Real qb;
    Real q1;
    Real q2;
    Real arg;
    Real sqarg;
    Real cc;
  Modelica.SIunits.Current cex;
  Modelica.SIunits.Conductance gex;
  Modelica.SIunits.Time ttime;
    Real step;
    Real laststep;
  Modelica.SIunits.Current bcex0;
  Modelica.SIunits.Current bcex1;
    Real arg1;
    Real arg2;
    Real denom;
    Real arg3;
    Real rbpr;
    Real rbpi;
    Real gx;
    Real xjrb;
    Real go;
    Real gm;
  Real captt;
  Modelica.SIunits.Charge chargebe;
  Modelica.SIunits.Charge chargebc;
  Modelica.SIunits.Charge chargebx;
    Real argtf;
    Real exponent;
  Modelica.SIunits.Temp_K temp;

    Real aux1;
    Real aux2;

algorithm 
  vce := in_p.m_type * (in_m_pVoltageValues[4] - in_m_pVoltageValues[6]); // ( ColP, EmitP);
  vbe := in_p.m_type * (in_m_pVoltageValues[5] - in_m_pVoltageValues[6]); // ( BaseP, EmitP);
  vbx := in_p.m_type * (in_m_pVoltageValues[2] - in_m_pVoltageValues[4]); // ( Base, ColP);

  if (SpiceRoot.useInitialConditions()) then
    if (in_p3.m_bICvbeIsGiven &gt; 0.5) then
      vbe := in_p.m_type * in_p3.m_dICvbe;
    end if;
    if (in_p3.m_bICvceIsGiven &gt; 0.5) then
      vce := in_p.m_type * in_p3.m_dICvce;
    end if;
    vbx := vbe - vce;
  elseif (SpiceRoot.initJunctionVoltages()) then
    if (in_p3.m_bOff) then
      vbe := 0.0;
      vce := 0.0;
      vbx := 0.0;
    else
      vbe := in_c.m_tVcrit;
      vce := vbe;
      vbx := 0.0;
    end if;
  end if;

  vbc := vbe - vce;

    // junction current
  (cbe,gbe) := Modelica.Electrical.Spice3.Internal.Functions.junction2(
          vbe,
          in_m.m_dTemp,
          in_p.m_emissionCoeffF,
          in_c.m_tSatCur);

  out_cc.iBE   := in_p.m_type * cbe / in_c.m_tBetaF;
  (cben,gben) := Modelica.Electrical.Spice3.Internal.Functions.junction2(
          vbe,
          in_m.m_dTemp,
          in_p.m_leakBEemissionCoeff,
          in_c.m_tBEleakCur);
  out_cc.iBEN  := in_p.m_type * cben;
  (cbc,gbc) := Modelica.Electrical.Spice3.Internal.Functions.junction2(
          vbc,
          in_m.m_dTemp,
          in_p.m_emissionCoeffR,
          in_c.m_tSatCur);
  out_cc.iBC   := in_p.m_type * cbc / in_c.m_tBetaR;
  (cbcn,gbcn) := Modelica.Electrical.Spice3.Internal.Functions.junction2(
          vbc,
          in_m.m_dTemp,
          in_p.m_leakBCemissionCoeff,
          in_c.m_tBCleakCur);
  out_cc.iBCN  := in_p.m_type * cbcn;
  cjbe         := cbe / in_c.m_tBetaF + cben;
  cjbc         := cbc / in_c.m_tBetaR + cbcn;

  // determine base charge terms
  q1 := 1.0/(1.0 - in_p.m_invEarlyVoltF * vbc - in_p.m_invEarlyVoltR * vbe);
  if (in_vl.m_invRollOffF == 0 and in_vl.m_invRollOffR == 0) then
    qb     := q1;
    dqbdve := q1*qb*in_p.m_invEarlyVoltR;
    dqbdvc := q1*qb*in_p.m_invEarlyVoltF;
  else
    q2    := in_vl.m_invRollOffF*cbe + in_vl.m_invRollOffR*cbc;
    arg   := max( 0.0, 1+4*q2);
    sqarg := 1;
    if (arg &lt;&gt; 0) then
      sqarg := sqrt(arg);
    end if;
    qb     := q1*(1+sqarg)/2;
    dqbdve := q1*(qb*in_p.m_invEarlyVoltR + in_vl.m_invRollOffF*gbe/sqarg);
    dqbdvc := q1*(qb*in_p.m_invEarlyVoltF + in_vl.m_invRollOffR*gbc/sqarg);
  end if;

  // determine dc incremental conductances - Weil&#39;s approximation
  cc    := 0.0;
  cex   := cbe;
  gex   := gbe;
  ttime := 1;
  if ((in_vl.m_excessPhaseFactor &lt;&gt; 0) and (ttime &gt; 0.0)) then
    step     :=0;
    laststep :=1;
    bcex0    :=0;
    bcex1    :=0;
    if ( bcex1 == 0.0) then
         bcex1 := cbe / qb;
         bcex0 := bcex1;

    end if;
    arg1  := step / in_vl.m_excessPhaseFactor;
    arg2  := 3 * arg1;
    arg1  := arg2 * arg1;
    denom := 1 + arg1 + arg2;
    arg3  := arg1 / denom;
    cc    := (bcex0 * (1 + step / laststep + arg2) -
             bcex1 * step / laststep) / denom;
    cex   := cbe * arg3;
    gex   := gbe * arg3;

  end if;
  cc := cc+(cex-cbc)/qb;

  // resistances
  rbpr := in_vl.m_minBaseResist / in_p3.m_area;
  rbpi := in_p.m_baseResist / in_p3.m_area-rbpr;
  gx   := rbpr + rbpi / qb;
  xjrb := in_p.m_baseCurrentHalfResist * in_p3.m_area;
  if (xjrb &lt;&gt; 0) then
    arg1 := max( (cjbe + cjbc) / xjrb, 1e-9);
    arg2 := (-1 + sqrt( 1 + 14.59025 * arg1)) / 2.4317 / sqrt( arg1);
    arg1 := tan(arg2);
    gx   := rbpr + 3 * rbpi * (arg1-arg2) / arg2 / arg1 / arg1;
  end if;
  if (gx &lt;&gt; 0) then
    gx := 1 / gx;
  end if;

  // determine dc incremental conductances
  go := (gbc+(cex-cbc)*dqbdvc/qb)/qb;
  gm := (gex-(cex-cbc)*dqbdve/qb)/qb - go;
  out_cc.iCC := in_p.m_type * cc;

  // charge storage elements and transit time calculation
  captt := 0.0;
  if (in_p.m_transitTimeF &lt;&gt; 0.0 and vbe &gt; 0.0) then
    argtf := 0.0;
    arg2  := 0.0;
    arg3  := 0.0;
    if (in_p.m_transitTimeBiasCoeffF &lt;&gt; 0.0) then
      argtf := in_p.m_transitTimeBiasCoeffF;
      if (in_vl.m_transitTimeVBCFactor &lt;&gt; 0.0) then
        exponent := min( 50., vbc * in_vl.m_transitTimeVBCFactor);
        argtf    := argtf * exp( exponent);
      end if;
        arg2 := argtf;
        if (in_p.m_transitTimeHighCurrentF &lt;&gt; 0) then
          temp  := cbe / (cbe + in_p.m_transitTimeHighCurrentF);
          argtf := argtf * temp * temp;
          arg2  := argtf * (3-temp-temp);
        end if;
        arg3 := cbe * argtf * in_vl.m_transitTimeVBCFactor;
    end if;
    cbe   := cbe * (1 + argtf) / qb;
    gbe   := (gbe * (1 + arg2) - cbe * dqbdve) / qb;
    captt := in_p.m_transitTimeF * (arg3 - cbe * dqbdvc) / qb;
  end if;
  (capbe,chargebe) :=
    Modelica.Electrical.Spice3.Internal.Functions.junctionCapTransTime(
          in_c.m_tBEcap,
          vbe,
          in_c.m_tDepCapBE,
          in_p.m_junctionExpBE,
          in_c.m_tBEpot,
          in_c.m_tF1e,
          in_c.m_f2e,
          in_c.m_f3e,
          in_p.m_transitTimeF,
          gbe,
          cbe);

  out_cc.iXX        := 0;
  aux1 := in_c.m_tBCcap*in_p.m_baseFractionBCcap;
  (capbc,chargebc) :=
    Modelica.Electrical.Spice3.Internal.Functions.junctionCapTransTime(
          aux1,
          vbc,
          in_c.m_tDepCapBC,
          in_p.m_junctionExpBC,
          in_c.m_tBCpot,
          in_c.m_tF1c,
          in_c.m_f2c,
          in_c.m_f3c,
          in_p.m_transitTimeR,
          gbc,
          cbc);

  aux2:= in_c.m_tBCcap*(1. - in_p.m_baseFractionBCcap);
  (capbx,chargebx) :=
    Modelica.Electrical.Spice3.Internal.Functions.junctionCap(
          aux2,
          vbx,
          in_c.m_tDepCapBC,
          in_p.m_junctionExpBC,
          in_c.m_tBCpot,
          in_c.m_tF1c,
          in_c.m_f2c,
          in_c.m_f3c);

end bjt3NoBypassCode;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjt"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.Bjt</h1>
<p><strong>Record for bjt device parameters</strong></p>
<h2 id="information-11">Information</h2>
<p>::</p>
<p>This record contains the device parameters that are used for the bipolar transistor bjt model in SPICE3.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a> (Record for bjt3 device parameters).</p>
<h2 id="parameters">Parameters</h2>
<table>
<col width="49%" />
<col width="28%" />
<col width="9%" />
<col width="12%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Initialization</td>
<td align="left">
</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_area.start</td>
<td align="left">1.0</td>
<td align="left">AREA</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">m_bOff.start</td>
<td align="left">false</td>
<td align="left">OFF</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">m_dICvbe.start</td>
<td align="left">0.0</td>
<td align="left">IC_VBE [V]</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_bICvbeIsGiven.start</td>
<td align="left">0.0</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">m_dICvce.start</td>
<td align="left">0.0</td>
<td align="left">IC_VCE [V]</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_bICvceIsGiven.start</td>
<td align="left">0.0</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">m_bSensArea.start</td>
<td align="left">false</td>
<td align="left">SENS_AREA</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_transitTimeHighCurrentF.start</td>
<td align="left">0.0</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_invRollOffF.start</td>
<td align="left">0</td>
<td align="left">
</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_invRollOffR.start</td>
<td align="left">0</td>
<td align="left">
</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-10">Modelica definition</h2>
<pre><code>record Bjt &quot;Record for bjt device parameters&quot;
  extends Bjt3;
end Bjt;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtvariables"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.BjtVariables</h1>
<p><strong>Variables for the bjt model</strong></p>
<h2 id="information-12">Information</h2>
<p>::</p>
<p>This record contains the model variables that are used for the bipoar transistor bjt model in SPICE3.</p>
<p>::</p>
<p>Extends from <a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Variables">Bjt3Variables</a> (Variables for the bjt3 model).</p>
<h2 id="parameters-1">Parameters</h2>
<table>
<col width="49%" />
<col width="28%" />
<col width="9%" />
<col width="12%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Initialization</td>
<td align="left">
</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Current">Current</a></td>
<td align="left">m_transitTimeHighCurrentF.start</td>
<td align="left">0.0</td>
<td align="left">[A]</td>
</tr>
<tr class="odd">
<td align="left">Real</td>
<td align="left">m_invRollOffF.start</td>
<td align="left">0.0</td>
<td align="left">
</td>
</tr>
<tr class="even">
<td align="left">Real</td>
<td align="left">m_invRollOffR.start</td>
<td align="left">0.0</td>
<td align="left">
</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-11">Modelica definition</h2>
<pre><code>record BjtVariables &quot;Variables for the bjt model&quot;
  extends Bjt3Variables;

  Real m_CScap;

end BjtVariables;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtinitequations"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtInitEquations</h1>
<p><strong>Initial calculation</strong></p>
<h2 id="information-13">Information</h2>
<p>::</p>
<p>Within this function some parameters are initially precalculated from model line parameters.</p>
<p>::</p>
<h2 id="inputs-4">Inputs</h2>
<table>
<col width="66%" />
<col width="5%" />
<col width="5%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt">Bjt</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record Bjt</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_pml</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">in_vl</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line variables</td>
</tr>
</tbody>
</table>
<h2 id="outputs-4">Outputs</h2>
<table>
<col width="71%" />
<col width="6%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtVariables">BjtVariables</a></td>
<td align="left">out_v</td>
<td align="left">Output record with Bjt variables</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-12">Modelica definition</h2>
<pre><code>function bjtInitEquations &quot;Initial calculation&quot;

  input Bjt in_p &quot;Input record Bjt&quot;;
  input BjtModelLineParams in_pml &quot;Input record with Bjt model line parameters&quot;;
  input BjtModelLineVariables in_vl 
    &quot;Input record with Bjt model line variables&quot;;
  output BjtVariables out_v &quot;Output record with Bjt variables&quot;;

protected 
  Bjt3Variables v3 &quot;Record with Bjt variables&quot;;

algorithm 
  v3 := bjt3InitEquations(in_p, in_pml, in_vl);
  // calculate the parameters that depend on the area factor
  out_v.m_CScap := in_pml.m_capCS * in_p.m_area;

end bjtInitEquations;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtnobypasscode"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtNoBypassCode</h1>
<p><strong>Calculation of currents</strong></p>
<h2 id="information-14">Information</h2>
<p>::</p>
<p>This function NoBypassCode calculates the currents (and the capacitances) that are necessary for the currents to be used in the toplevel model.</p>
<p>::</p>
<h2 id="inputs-5">Inputs</h2>
<table>
<col width="61%" />
<col width="12%" />
<col width="5%" />
<col width="20%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Model.html#Modelica.Electrical.Spice3.Internal.Model.Model">Model</a></td>
<td align="left">in_m</td>
<td align="left">
</td>
<td align="left">Input record model</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a></td>
<td align="left">in_p3</td>
<td align="left">
</td>
<td align="left">Input record Bjt3</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">in_p</td>
<td align="left">
</td>
<td align="left">Input record with Bjt model line parameters</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3Calc">Bjt3Calc</a></td>
<td align="left">in_c</td>
<td align="left">
</td>
<td align="left">Input record Bjt3Calc</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtVariables">BjtVariables</a></td>
<td align="left">in_v</td>
<td align="left">
</td>
<td align="left">Input record with Bjt variables</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineVariables">BjtModelLineVariables</a></td>
<td align="left">in_vl</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">in_m_pVoltageValues[6]</td>
<td align="left">
</td>
<td align="left">[V]</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">in_m_bInit</td>
<td align="left">
</td>
<td align="left">
</td>
</tr>
</tbody>
</table>
<h2 id="outputs-5">Outputs</h2>
<table>
<col width="65%" />
<col width="5%" />
<col width="28%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.CurrentsCapacitances">CurrentsCapacitances</a></td>
<td align="left">out_cc</td>
<td align="left">Output record with calculated currents and capacitances</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbe</td>
<td align="left">Capacitance [F]</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbc</td>
<td align="left">Capacitance [F]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Capacitance">Capacitance</a></td>
<td align="left">capbx</td>
<td align="left">Capacitance [F]</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-13">Modelica definition</h2>
<pre><code>function bjtNoBypassCode &quot;Calculation of currents&quot;

  input Model.Model in_m &quot;Input record model&quot;;
  input Bjt3 in_p3 &quot;Input record Bjt3&quot;;
  input BjtModelLineParams in_p &quot;Input record with Bjt model line parameters&quot;;
  input Bjt3Calc in_c &quot;Input record Bjt3Calc&quot;;
  input BjtVariables in_v &quot;Input record with Bjt variables&quot;;
  input BjtModelLineVariables in_vl;
  input Modelica.SIunits.Voltage[6] in_m_pVoltageValues; /* 1 Col; 2 Base; 3 Emit; 4 Subst; 5 ColP; 6 BaseP; 7 EmitP */

  input Boolean in_m_bInit;

  output CurrentsCapacitances out_cc 
    &quot;Output record with calculated currents and capacitances&quot;;

  output Modelica.SIunits.Capacitance capbe &quot;Capacitance&quot;;
  output Modelica.SIunits.Capacitance capbc &quot;Capacitance&quot;;
  output Modelica.SIunits.Capacitance capbx &quot;Capacitance&quot;;
protected 
  Modelica.SIunits.Voltage[6] bjt3_VoltageValues; /* 1 Col; 2 Base; 3 Emit; 4 ColP; 5 BaseP; 6 EmitP */
  Integer i;
  Modelica.SIunits.Capacitance capcs;
  Modelica.SIunits.Charge chargecs;
  Modelica.SIunits.Voltage vcs;
  Real arg;
  Real sarg;

algorithm 
  // Bjt3 has got only 6 pins, therefore new vector VoltageValues
  for i in 1:3 loop
    bjt3_VoltageValues[i] := in_m_pVoltageValues[i];
  end for;
  for i in 4:6 loop
    bjt3_VoltageValues[i] := in_m_pVoltageValues[i];
  end for;

  (out_cc, capbe, capbc, capbx)   := bjt3NoBypassCode(in_m, in_p3, in_p, in_c, in_vl, bjt3_VoltageValues,
               in_m_bInit);
  capcs    := 0;
  chargecs := 0;
  vcs      := in_p.m_type * (0- in_m_pVoltageValues[4]); // ( Subst,  ColP);
  if (vcs &lt; 0) then
    arg      := 1 - vcs / in_p.m_potentialSubstrate;
    sarg     := exp( -in_p.m_exponentialSubstrate * Modelica.Math.log( arg));
    capcs    := in_v.m_CScap * sarg;
    chargecs := in_p.m_potentialSubstrate * in_v.m_CScap *
                (1-arg*sarg)/(1-in_p.m_exponentialSubstrate);
  else
    capcs    := in_v.m_CScap * (1 + in_p.m_exponentialSubstrate * vcs / in_p.m_potentialSubstrate);
    chargecs := vcs * in_v.m_CScap *(1+in_p.m_exponentialSubstrate*vcs/
                                 (2*in_p.m_potentialSubstrate));
  end if;

end bjtNoBypassCode;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtrenameparameters"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtRenameParameters</h1>
<p><strong>Technology parameter renaming</strong></p>
<h2 id="information-15">Information</h2>
<p>::</p>
<p>This function assigns the external (given by the user, e.g., IS) technology parameters to the internal parameters (e.g., m_satCur). It also does the analysis of the IsGiven values.</p>
<p>::</p>
<h2 id="inputs-6">Inputs</h2>
<table>
<col width="64%" />
<col width="5%" />
<col width="6%" />
<col width="23%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.ModelcardBJT">ModelcardBJT</a></td>
<td align="left">ex</td>
<td align="left">
</td>
<td align="left">Modelcard with technologie parameters</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal.html#Modelica.Electrical.Spice3.Internal.SpiceConstants">SpiceConstants</a></td>
<td align="left">con</td>
<td align="left">
</td>
<td align="left">Spice constants</td>
</tr>
</tbody>
</table>
<h2 id="outputs-6">Outputs</h2>
<table>
<col width="69%" />
<col width="5%" />
<col width="25%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">intern</td>
<td align="left">Output record with Bjt model line parameters</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-14">Modelica definition</h2>
<pre><code>function bjtRenameParameters &quot;Technology parameter renaming&quot;
  input ModelcardBJT ex &quot;Modelcard with technologie parameters&quot;;
  input SpiceConstants con &quot;Spice constants&quot;;

  output BjtModelLineParams intern 
    &quot;Output record with Bjt model line parameters&quot;;
algorithm 

  intern.m_satCur := ex.IS;
  intern.m_betaF := ex.BF;
  intern.m_emissionCoeffF := ex.NF;
  intern.m_leakBEemissionCoeff := ex.NE;

  intern.m_leakBEcurrentIsGiven := if (ex.ISE &gt; -1e40) then 1 else 0;
  intern.m_leakBEcurrent := if 
                              (ex.ISE &gt; -1e40) then ex.ISE else 0;

  intern.m_c2IsGiven := if (ex.C2 &gt; -1e40) then 1 else 0;
  intern.m_c2 := if (ex.C2 &gt; -1e40) then ex.C2 else 0;

  intern.m_leakBCcurrentIsGiven := if (ex.ISC &gt; -1e40) then 1 else 0;
  intern.m_leakBCcurrent := if (ex.ISC &gt; -1e40) then ex.ISC else 0;

  intern.m_c4IsGiven := if (ex.C4 &gt; -1e40) then 1 else 0;
  intern.m_c4 := if (ex.C4 &gt; -1e40) then ex.C4 else 0;

  intern.m_betaR := ex. BR;
  intern.m_emissionCoeffR := ex.NR;
  intern.m_leakBCemissionCoeff := ex.NC;
  intern.m_earlyVoltF := ex.VAF;
  intern.m_rollOffF := ex.IKF;
  intern.m_earlyVoltR := ex.VAR;
  intern.m_rollOffR := ex.IKR;
  intern.m_emitterResist := ex.RE;
  intern.m_collectorResist := ex.RC;
  intern.m_baseCurrentHalfResist := ex.IRB;
  intern.m_baseResist := ex.RB;

  intern.m_minBaseResistIsGiven := if (ex.RBM &gt; -1e40) then 1 else 0;
  intern.m_minBaseResist := if (ex.RBM &gt; -1e40) then ex.RBM else 0;

  intern.m_depletionCapBE :=ex.CJE;
  intern.m_potentialBE :=ex.VJE;
  intern.m_junctionExpBE := ex.MJE;
  intern.m_transitTimeF :=ex.TF;
  intern.m_transitTimeBiasCoeffF := ex.XTF;
  intern.m_transitTimeHighCurrentF := ex.ITF;
  intern.m_transitTimeFVBC :=ex.VTF;
  intern.m_excessPhase := ex.PTF;
  intern.m_depletionCapBC := ex.CJC;
  intern.m_potentialBC := ex.VJC;
  intern.m_junctionExpBC := ex.MJC;
  intern.m_baseFractionBCcap := ex.XCJC;
  intern.m_transitTimeR := ex.TR;
  intern.m_capCS := ex.CJS;
  intern.m_potentialSubstrate := ex.VJS;
  intern.m_exponentialSubstrate := ex.MJS;
  intern.m_betaExp := ex.XTB;
  intern.m_energyGap := ex.EG;
  intern.m_tempExpIS := ex.XTI;
  intern.m_fNcoef := ex.KF;
  intern.m_fNexp := ex.AF;
  intern.m_depletionCapCoeff :=ex.FC;
  intern.m_tnom := if (ex.TNOM &gt; -1e40) then ex.TNOM + SpiceConstants.CONSTCtoK else 300.15;

end bjtRenameParameters;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtrenameparametersdev"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtRenameParametersDev</h1>
<p><strong>Temperature calculation</strong></p>
<h2 id="information-16">Information</h2>
<p>::</p>
<p>This function assigns the external (given by the user, e.g., AREA) device parameters to the internal parameters (e.g., m_area). It also does the analysis of the IsGiven values.</p>
<p>::</p>
<h2 id="inputs-7">Inputs</h2>
<table>
<col width="35%" />
<col width="8%" />
<col width="6%" />
<col width="49%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Real</td>
<td align="left">AREA</td>
<td align="left">
</td>
<td align="left">Area factor</td>
</tr>
<tr class="even">
<td align="left">Boolean</td>
<td align="left">OFF</td>
<td align="left">
</td>
<td align="left">Optional initial condition: false - IC not used, true - IC used, not implemented yet</td>
</tr>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">IC_VBE</td>
<td align="left">
</td>
<td align="left">Initial condition value, not yet implemented [V]</td>
</tr>
<tr class="even">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Voltage">Voltage</a></td>
<td align="left">IC_VCE</td>
<td align="left">
</td>
<td align="left">Initial condition value, not yet implemented [V]</td>
</tr>
<tr class="odd">
<td align="left">Boolean</td>
<td align="left">SENS_AREA</td>
<td align="left">
</td>
<td align="left">Flag for sensitivity analysis, not yet implemented</td>
</tr>
</tbody>
</table>
<h2 id="outputs-7">Outputs</h2>
<table>
<col width="76%" />
<col width="6%" />
<col width="16%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.Bjt3">Bjt3</a></td>
<td align="left">dev</td>
<td align="left">Output record Bjt3</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-15">Modelica definition</h2>
<pre><code>function bjtRenameParametersDev &quot;Temperature calculation&quot;
 input Real AREA &quot;Area factor&quot;;
 input Boolean OFF 
    &quot;Optional initial condition: false - IC not used, true - IC used, not implemented yet&quot;;
 input Modelica.SIunits.Voltage IC_VBE 
    &quot;Initial condition value, not yet implemented&quot;;
 input Modelica.SIunits.Voltage IC_VCE 
    &quot;Initial condition value, not yet implemented&quot;;
 input Boolean SENS_AREA &quot;Flag for sensitivity analysis, not yet implemented&quot;;

 output Bjt3 dev &quot;Output record Bjt3&quot;;

algorithm 
  dev.m_area := AREA;
  dev.m_bOff := OFF;

  dev.m_bICvbeIsGiven := if (IC_VBE &gt; -1e40) then 1 else 0;
  dev.m_dICvbe := if (IC_VBE &gt; -1e40) then IC_VBE else 0;

  dev.m_bICvceIsGiven := if (IC_VCE &gt; -1e40) then 1 else 0;
  dev.m_dICvce := if (IC_VCE &gt; -1e40) then IC_VCE else 0;

  dev.m_bSensArea := SENS_AREA;

end bjtRenameParametersDev;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtrenameparametersdevtemp"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtRenameParametersDevTemp</h1>
<p><strong>Temperature calculation</strong></p>
<h2 id="information-17">Information</h2>
<p>::</p>
<p>This function calculates device parameters wehich are temperature dependent.</p>
<p>::</p>
<h2 id="inputs-8">Inputs</h2>
<table>
<col width="58%" />
<col width="8%" />
<col width="11%" />
<col width="21%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_SIunits.html#Modelica.SIunits.Temp_C">Temp_C</a></td>
<td align="left">TEMP</td>
<td align="left">
</td>
<td align="left">Temperature [degC]</td>
</tr>
</tbody>
</table>
<h2 id="outputs-8">Outputs</h2>
<table>
<col width="76%" />
<col width="6%" />
<col width="16%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Model.html#Modelica.Electrical.Spice3.Internal.Model.Model">Model</a></td>
<td align="left">m</td>
<td align="left">Output record model</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-16">Modelica definition</h2>
<pre><code>function bjtRenameParametersDevTemp &quot;Temperature calculation&quot;
 input Modelica.SIunits.Temp_C TEMP &quot;Temperature&quot;;

output Model.Model m &quot;Output record model&quot;;
algorithm 

 m.m_dTemp :=TEMP + SpiceConstants.CONSTCtoK;

end bjtRenameParametersDevTemp;</code></pre>
<hr />
<h1 id="modelica.electrical.spice3.internal.bjt3.bjtrenameparameterstype"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3">Modelica.Electrical.Spice3.Internal.Bjt3</a>.bjtRenameParametersType</h1>
<p><strong>Type</strong></p>
<h2 id="information-18">Information</h2>
<p>::</p>
<p>This function assigns the external (given by the user, e.g. AREA) device parameters to the internal parameters (e.g. m_area). It also does the analysis of the IsGiven values.</p>
<p>::</p>
<h2 id="inputs-9">Inputs</h2>
<table>
<col width="12%" />
<col width="12%" />
<col width="16%" />
<col width="22%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Real</td>
<td align="left">TBJT</td>
<td align="left">
</td>
<td align="left">Type</td>
</tr>
</tbody>
</table>
<h2 id="outputs-9">Outputs</h2>
<table>
<col width="78%" />
<col width="8%" />
<col width="12%" />
<thead>
<tr class="header">
<th align="left">Type</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="Modelica_Electrical_Spice3_Internal_Bjt3.html#Modelica.Electrical.Spice3.Internal.Bjt3.BjtModelLineParams">BjtModelLineParams</a></td>
<td align="left">dev_type</td>
<td align="left">Outputrecord Bjt3</td>
</tr>
</tbody>
</table>
<h2 id="modelica-definition-17">Modelica definition</h2>
<pre><code>function bjtRenameParametersType &quot;Type&quot;

 input Real TBJT &quot;Type&quot;;
 output BjtModelLineParams dev_type &quot;Outputrecord Bjt3&quot;;
algorithm 
  dev_type.m_type := TBJT;

end bjtRenameParametersType;</code></pre>
<hr />
<p><a href="http://www.3ds.com/">Automatically generated</a> Fri Nov 12 16:29:47 2010.</p>
</body>
</html>
